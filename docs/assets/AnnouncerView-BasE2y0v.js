import{r as C,y as q,z as J,u as t,A as N,_ as K,B as H,b as W,o as i,c as m,e as y,d as s,F as R,g as b,w as T,f as P,i as Z,x as ee,j as O,t as f,l as p,p as k,m as B,q as ne,s as te,h as ae}from"./index-D0Xn_xV6.js";import{a as oe,u as M,C as j,x as ue,_ as le,b as ie,c as se}from"./super-vue3-tabs-CoZNwtCx.js";function de(S,{volume:d=1,playbackRate:v=1,soundEnabled:D=!0,interrupt:x=!1,autoplay:I=!1,onload:E,...V}={}){const r=C(null),_=C(!1),A=C(null),u=C(null);function L(){var l;typeof E=="function"&&E.call(this),A.value=(A.value||((l=u.value)==null?void 0:l.duration())||0)*1e3,I===!0&&(_.value=!0)}return q(async()=>{const l=await J(()=>import("./howler-CCqh-U3u.js").then($=>$.h),[]);r.value=l.default.Howl,u.value=new r.value({src:t(S),volume:t(d),rate:t(v),onload:L,...V})}),N(()=>[S],()=>{r.value&&r.value&&u&&u.value&&(u.value=new r.value({src:t(S),volume:t(d),rate:t(v),onload:L,...V}))}),N(()=>[t(d),t(v)],()=>{u.value&&(u.value.volume(t(d)),u.value.rate(t(v)))}),{play:l=>{typeof l>"u"&&(l={}),!(!u.value||!D&&!l.forceSoundEnabled)&&(x&&u.value.stop(),l.playbackRate&&u.value.rate(l.playbackRate),u.value.play(l.id),u.value.once("end",()=>{u.value&&u.value&&!u.value.playing()&&(_.value=!1)}),_.value=!0)},sound:u,isPlaying:_,duration:A,pause:l=>{u.value&&(u.value.pause(typeof l=="number"?l:void 0),_.value=!1)},stop:l=>{u.value&&(u.value.stop(typeof l=="number"?l:void 0),_.value=!1)}}}const re="/Pathe-Tools/assets/tts-Duupk8vV.mp3",Q=S=>(ne("data-v-830f572c"),S=S(),te(),S),ce={class:"container dark"},me={key:0},fe=Q(()=>s("h2",null,"Geplande omroepen",-1)),pe={class:"flex",style:{"flex-wrap":"wrap"}},ve={id:"upcoming-announcements",class:"flex",style:{"flex-direction":"column",gap:"8px"}},_e={class:"room"},he={class:"title"},Te={class:"time"},ge={id:"parameters",style:{flex:"229px 1 1"}},ye={key:0},Se={key:0,class:"small"},Ve={key:0,class:"small"},Ue={class:"flex",style:{"flex-wrap":"wrap",gap:"8px"}},De={class:"queue"},xe=Q(()=>s("span",{class:"icon-speaker loud"},null,-1)),Ie={__name:"AnnouncerView",setup(S){const d=oe(),v=C(()=>new Date);setInterval(()=>{v.value=new Date},1e3);const D=M("announce-start",!1),x=M("announce-plf-start",!0),I=M("announce-plf-start-grace-period",15),E=M("announce-main-show",!1),V=M("announce-credits",!0),r=M("announce-credits-grace-period",60),_=M("announce-end",!1);function A(o){const e={start:"start",mainshow:"start hoofdfilm",credits:"aftiteling",end:"einde voorstelling"};let a=o.match(/^(auditorium)([0-9]+)$/);return e[o]?e[o]:a?`zaal ${a[2]}`:o}const u={auditorium1:[0,1055],auditorium2:[2e3,1055],auditorium3:[4e3,1055],auditorium4:[6e3,1055],auditorium5:[8e3,1055],auditorium6:[1e4,1055],auditorium7:[12e3,1055],credits:[14e3,1055]},{play:L,isPlaying:X}=de(re,{sprite:u,preload:!0,onplay:async()=>{document.dispatchEvent(new Event("announcerSoundPlay"))},onend:async()=>{document.dispatchEvent(new Event("announcerSoundEnd"))}});let g=H([]);N(g,async o=>{if(o[0]&&!u[o[0].id]&&g.shift(),o[0]&&!X.value){const e=g[0];L(e),document.addEventListener("announcerSoundEnd",()=>{g.shift()},{once:!0})}},{deep:!0});const w=W(()=>{let o=[];return D.value&&d.table.forEach(e=>{var a;e.scheduledTime&&o.push({announceTime:e.scheduledTime,announcement:["start",`auditorium${(a=e.AUDITORIUM)==null?void 0:a.match(/\d+/)}`],...e})}),x.value&&d.table.filter(e=>{var a;return(a=e.AUDITORIUM)==null?void 0:a.includes("4DX")}).forEach(e=>{var a;e.scheduledTime&&o.push({announceTime:new Date(e.scheduledTime.getTime()-I.value*6e4),announcement:["start",`auditorium${(a=e.AUDITORIUM)==null?void 0:a.match(/\d+/)}`],...e})}),E.value&&d.table.forEach(e=>{var a;e.scheduledTime&&o.push({announceTime:e.featureTime,announcement:["mainshow",`auditorium${(a=e.AUDITORIUM)==null?void 0:a.match(/\d+/)}`],...e})}),V.value&&d.table.forEach(e=>{var a;e.creditsTime&&o.push({announceTime:new Date(e.creditsTime.getTime()-r.value*1e3),announcement:["credits",`auditorium${(a=e.AUDITORIUM)==null?void 0:a.match(/\d+/)}`],...e})}),_.value&&d.table.forEach(e=>{var a;e.scheduledTime&&o.push({announceTime:e.endTime,announcement:["end",`auditorium${(a=e.AUDITORIUM)==null?void 0:a.match(/\d+/)}`],...e})}),o||[]}),U=H([]);N(w,l),l(w.value);function l(o){for(;U.length>0;)U.pop();o.sort((e,a)=>e.announceTime-a.announceTime).forEach(e=>{e.announceTime<Date.now()||(U.push(e),setTimeout(()=>{let a=U.findIndex(c=>e.announceTime===c.announceTime&&e.announcement.join()===c.announcement.join());a&&(e.announcement.forEach(c=>{g.push({id:c})}),setTimeout(()=>{a=U.findIndex(c=>e.announceTime===c.announceTime&&e.announcement.join()===c.announcement.join()),a&&U.splice(a,1)},1e4))},e.announceTime-Date.now()))})}function $(o){return o<6e4?Math.floor(o/1e3)+" s":o<6e5?Math.floor(o/6e4)+":"+String(Math.floor(o%6e4/1e3)).padStart(2,"0")+" min":o<36e5?Math.floor(o/6e4)+" min":Math.floor(o/36e5)+":"+String(Math.floor(o%36e5/6e4)).padStart(2,"0")+" h"}return(o,e)=>{const a=le,c=ie,G=se,Y=ae;return i(),m("div",ce,[y(a),t(d).table.length>0?(i(),m("section",me,[fe,s("div",pe,[s("div",ve,[(i(!0),m(R,null,b(U,n=>Z((i(),m("div",{class:O(["film",{announced:n.announceTime<=v.value}])},[s("div",_e,f(n.AUDITORIUM==="PULR 8"?"RT":n.AUDITORIUM.replace(/^\w+\s/,"")),1),s("div",he,f(n.PLAYLIST),1),s("div",Te,f(n.scheduledTime.toLocaleTimeString("nl-NL"))+" – "+f(n.endTime.toLocaleTimeString("nl-NL")),1),s("div",{class:O(["announcement",n.announcement]),style:{display:"grid","grid-template-columns":"64px 130px 1fr"}},[s("span",{class:O(["icon-speaker",{loud:n.announceTime<=v.value}]),style:{"justify-self":"center",opacity:"0.5"}},null,2),s("div",null,f(n.announceTime.toLocaleTimeString("nl-NL"))+" ("+f($(n.announceTime-v.value))+") ",1),s("div",null,[p(" '"),(i(!0),m(R,null,b(n.announcement,(h,F)=>{var z;return i(),m("span",{class:O(["word",{announcing:n.announceTime<=v.value&&((z=t(g)[0])==null?void 0:z.id)===h}])},f(A(h))+f(F<n.announcement.length-1?" ":""),3)}),256)),p("' ")])],2)],2)),[[ee,v.value-n.announceTime<1e4]])),256))]),s("div",ge,[y(t(ue),{themeColor:"#ffc426"},{default:T(()=>[y(t(j),{value:"Opties"},{default:T(()=>[y(c,{modelValue:t(D),"onUpdate:modelValue":e[0]||(e[0]=n=>k(D)?D.value=n:null),identifier:"announceStart"},{default:T(()=>[p(" 'Start' omroepen ")]),_:1},8,["modelValue"]),t(d).table.some(n=>{var h;return(h=n.AUDITORIUM)==null?void 0:h.includes("4DX")})?(i(),B(c,{key:0,modelValue:t(x),"onUpdate:modelValue":e[1]||(e[1]=n=>k(x)?x.value=n:null),identifier:"announcePlfStart"},{default:T(()=>[s("span",null,[p("'Start' "),t(D)?(i(),m("b",ye,"extra")):P("",!0),p(" omroepen bij 4DX")])]),_:1},8,["modelValue"])):P("",!0),t(x)&&t(d).table.some(n=>{var h;return(h=n.AUDITORIUM)==null?void 0:h.includes("4DX")})?(i(),B(G,{key:1,modelValue:t(I),"onUpdate:modelValue":e[2]||(e[2]=n=>k(I)?I.value=n:null),modelModifiers:{number:!0},identifier:"announcePlfStartGracePeriod",min:"0",max:"30",unit:"min"},{default:T(()=>[p(" Voorlooptijd 'start' bij 4DX "),t(r)>0?(i(),m("div",Se," De 4DX-inloop wordt "+f(t(I))+" min van tevoren omgeroepen. ",1)):P("",!0)]),_:1},8,["modelValue"])):P("",!0),y(c,{modelValue:t(E),"onUpdate:modelValue":e[3]||(e[3]=n=>k(E)?E.value=n:null),identifier:"announceMainShow"},{default:T(()=>[p(" 'Start hoofdfilm' omroepen ")]),_:1},8,["modelValue"]),y(c,{modelValue:t(V),"onUpdate:modelValue":e[4]||(e[4]=n=>k(V)?V.value=n:null),identifier:"announceCredits"},{default:T(()=>[p(" 'Aftiteling' omroepen ")]),_:1},8,["modelValue"]),t(V)?(i(),B(G,{key:2,modelValue:t(r),"onUpdate:modelValue":e[5]||(e[5]=n=>k(r)?r.value=n:null),modelModifiers:{number:!0},identifier:"announceCreditsGracePeriod",step:"15",min:"0",max:"240",unit:"s"},{default:T(()=>[p(" Voorlooptijd 'aftiteling' "),t(r)>0?(i(),m("div",Ve," De aftiteling wordt "+f(t(r))+" s van tevoren omgeroepen. ",1)):P("",!0)]),_:1},8,["modelValue"])):P("",!0),y(c,{modelValue:t(_),"onUpdate:modelValue":e[6]||(e[6]=n=>k(_)?_.value=n:null),identifier:"announceEnd"},{default:T(()=>[p(" 'Einde voorstelling' omroepen ")]),_:1},8,["modelValue"])]),_:1}),y(t(j),{value:"Handmatig"},{default:T(()=>[s("div",Ue,[(i(),m(R,null,b(u,(n,h)=>y(Y,{onClick:F=>t(g).push({id:h})},{default:T(()=>[p(f(A(h)),1)]),_:2},1032,["onClick"])),64))]),s("div",De,[(i(!0),m(R,null,b(t(g),n=>(i(),m("div",null,[xe,p(" "+f(A(n.id)),1)]))),256))])]),_:1})]),_:1})])])])):P("",!0)])}}},Pe=K(Ie,[["__scopeId","data-v-830f572c"]]);export{Pe as default};
