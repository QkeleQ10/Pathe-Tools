import{r as C,y as Q,z as Y,u as a,A as k,_ as Z,B as J,o as i,c as v,e as T,d as r,F as O,g as N,f as A,w as m,i as K,x as W,j as w,t as f,l as c,p as P,m as G,q as ee,s as ne,C as te,h as ae}from"./index-BPO6mmv6.js";import{a as ue,u as E,C as q,x as le,_ as oe,b as se,c as ie}from"./super-vue3-tabs-MVBdav4U.js";function de(V,{volume:g=1,playbackRate:h=1,soundEnabled:D=!0,interrupt:U=!1,autoplay:x=!1,onload:I,...y}={}){const d=C(null),p=C(!1),b=C(null),l=C(null);function R(){var s;typeof I=="function"&&I.call(this),b.value=(b.value||((s=l.value)==null?void 0:s.duration())||0)*1e3,x===!0&&(p.value=!0)}return Q(async()=>{const s=await Y(()=>import("./howler-CCqh-U3u.js").then(B=>B.h),[]);d.value=s.default.Howl,l.value=new d.value({src:a(V),volume:a(g),rate:a(h),onload:R,...y})}),k(()=>[V],()=>{d.value&&d.value&&l&&l.value&&(l.value=new d.value({src:a(V),volume:a(g),rate:a(h),onload:R,...y}))}),k(()=>[a(g),a(h)],()=>{l.value&&(l.value.volume(a(g)),l.value.rate(a(h)))}),{play:s=>{typeof s>"u"&&(s={}),!(!l.value||!D&&!s.forceSoundEnabled)&&(U&&l.value.stop(),s.playbackRate&&l.value.rate(s.playbackRate),l.value.play(s.id),l.value.once("end",()=>{l.value&&l.value&&!l.value.playing()&&(p.value=!1)}),p.value=!0)},sound:l,isPlaying:p,duration:b,pause:s=>{l.value&&(l.value.pause(typeof s=="number"?s:void 0),p.value=!1)},stop:s=>{l.value&&(l.value.stop(typeof s=="number"?s:void 0),p.value=!1)}}}const ce="/Pathe-Tools/assets/tts-DZfGNdbN.ogg",re=V=>(ee("data-v-a7b588c7"),V=V(),ne(),V),me={class:"container dark"},fe={class:"flex",style:{"flex-wrap":"wrap"}},pe={key:0,style:{flex:"50% 1 1"}},ve=re(()=>r("h2",null,"Geplande omroepen",-1)),he={id:"upcoming-announcements",class:"flex",style:{"flex-direction":"column",gap:"8px"}},_e={class:"room"},Te={class:"title"},ge={class:"time"},ye={id:"parameters",style:{flex:"229px 1 1"}},Se={key:0},Ve={key:0,class:"small"},De={key:0,class:"small"},Ue={class:"flex",style:{"flex-wrap":"wrap",gap:"8px","margin-top":"-4px"}},xe={class:"queue"},Ie={__name:"AnnouncerView",setup(V){const g=ue(),h=C(()=>new Date);setInterval(()=>{h.value=new Date},1e3),E("announcement-voice","tts");const D=E("announce-start",!1),U=E("announce-plf-start",!0),x=E("announce-plf-start-grace-period",15),I=E("announce-main-show",!1),y=E("announce-credits",!0),d=E("announce-credits-grace-period",60),p=E("announce-end",!1);function b(n){const u={start:"start",mainshow:"start hoofdfilm",credits:"aftiteling",end:"einde voorstelling"};let e=n.match(/^(auditorium)([0-9]+)$/);return u[n]?u[n]:e?`zaal ${e[2]}`:n}const l={auditorium1:[0,1296.0090702947846],auditorium2:[3e3,1344.0136054421766],auditorium3:[6e3,1248.004535147392],auditorium4:[9e3,1368.0045351473923],auditorium5:[12e3,1488.0045351473932],auditorium6:[15e3,1440.0000000000014],auditorium7:[18e3,1488.0045351473932],credits:[21e3,1296.009070294783],end:[24e3,1728.0045351473916],mainshow:[27e3,1728.0045351473916],start:[3e4,1056.0090702947846]},{play:R,isPlaying:X}=de(ce,{sprite:l,preload:!0,onplay:async()=>{document.dispatchEvent(new Event("announcerSoundPlay"))},onend:async()=>{document.dispatchEvent(new Event("announcerSoundEnd"))}});let S=J([]);k(S,async n=>{if(n[0]&&!l[n[0].id]&&S.shift(),n[0]&&!X.value){const u=S[0];R(u),document.addEventListener("announcerSoundEnd",()=>{S.shift()},{once:!0})}},{deep:!0});const M=C([]);k([g,D,U,x,I,y,d,p],([n])=>$(n)),$(g);function $(n){let u=[];D.value&&n.table.forEach(e=>{var o;e.scheduledTime&&u.push({announceTime:e.scheduledTime,announcement:["start",`auditorium${(o=e.AUDITORIUM)==null?void 0:o.match(/\d+/)}`],status:"unscheduled",...e})}),U.value&&n.table.filter(e=>{var o;return(o=e.AUDITORIUM)==null?void 0:o.includes("4DX")}).forEach(e=>{var o;e.scheduledTime&&u.push({announceTime:new Date(e.scheduledTime.getTime()-x.value*6e4),announcement:["start",`auditorium${(o=e.AUDITORIUM)==null?void 0:o.match(/\d+/)}`],status:"unscheduled",...e})}),I.value&&n.table.forEach(e=>{var o;e.scheduledTime&&u.push({announceTime:e.featureTime,announcement:["mainshow",`auditorium${(o=e.AUDITORIUM)==null?void 0:o.match(/\d+/)}`],status:"unscheduled",...e})}),y.value&&n.table.forEach(e=>{var o;e.creditsTime&&u.push({announceTime:new Date(e.creditsTime.getTime()-d.value*1e3),announcement:["credits",`auditorium${(o=e.AUDITORIUM)==null?void 0:o.match(/\d+/)}`],status:"unscheduled",...e})}),p.value&&n.table.forEach(e=>{var o;e.scheduledTime&&u.push({announceTime:e.endTime,announcement:["end",`auditorium${(o=e.AUDITORIUM)==null?void 0:o.match(/\d+/)}`],status:"unscheduled",...e})}),M.value=[...M.value.filter(e=>e.status==="scheduled"),...u.filter(e=>e.announceTime>=Date.now()).sort((e,o)=>e.announceTime-o.announceTime)]}setInterval(s,3e4),k(M,s),s();function s(){M.value.filter(n=>n.announceTime-Date.now()<6e4&&n.status==="unscheduled").forEach(n=>{n.status="scheduled",setTimeout(()=>{n.status!=="unscheduled"&&(n.announcement.forEach(u=>{S.push({id:u})}),setTimeout(()=>{n.status="done"},1e4))},n.announceTime-Date.now())})}function B(n){return n<6e4?Math.floor(n/1e3)+" s":n<6e5?Math.floor(n/6e4)+":"+String(Math.floor(n%6e4/1e3)).padStart(2,"0")+" min":n<36e5?Math.floor(n/6e4)+" min":Math.floor(n/36e5)+":"+String(Math.floor(n%36e5/6e4)).padStart(2,"0")+" h"}return(n,u)=>{const e=oe,o=te,L=se,F=ie,j=ae;return i(),v("div",me,[T(e),r("section",null,[r("div",fe,[a(g).table.length>0?(i(),v("div",pe,[ve,r("div",he,[(i(!0),v(O,null,N(M.value,t=>K((i(),v("div",{class:w(["film",{announced:t.announceTime<=h.value}])},[r("div",_e,f(t.AUDITORIUM==="PULR 8"?"RT":t.AUDITORIUM.replace(/^\w+\s/,"")),1),r("div",Te,f(t.PLAYLIST),1),r("div",ge,f(t.scheduledTime.toLocaleTimeString("nl-NL"))+" – "+f(t.endTime.toLocaleTimeString("nl-NL")),1),r("div",{class:w(["announcement",t.announcement]),style:{display:"grid","grid-template-columns":"64px 130px 1fr"}},[T(o,{style:{"justify-self":"center",opacity:"0.5"},class:w({pulsate:t.status==="scheduled"})},{default:m(()=>[c(f(t.announceTime<=h.value?"graphic_eq":"schedule"),1)]),_:2},1032,["class"]),r("div",null,f(t.announceTime.toLocaleTimeString("nl-NL"))+" ("+f(B(t.announceTime-h.value))+") ",1),r("div",null,[c(" '"),(i(!0),v(O,null,N(t.announcement,(_,z)=>{var H;return i(),v("span",{class:w(["word",{announcing:t.announceTime<=h.value&&((H=a(S)[0])==null?void 0:H.id)===_}])},f(b(_))+f(z<t.announcement.length-1?" ":""),3)}),256)),c("' ")])],2)],2)),[[W,h.value-t.announceTime<1e4]])),256))])])):A("",!0),r("div",ye,[T(a(le),{themeColor:"#ffc426"},{default:m(()=>[T(a(q),{value:"Opties"},{default:m(()=>[T(L,{modelValue:a(D),"onUpdate:modelValue":u[0]||(u[0]=t=>P(D)?D.value=t:null),identifier:"announceStart"},{default:m(()=>[c(" 'Start' omroepen ")]),_:1},8,["modelValue"]),a(g).table.some(t=>{var _;return(_=t.AUDITORIUM)==null?void 0:_.includes("4DX")})?(i(),G(L,{key:0,modelValue:a(U),"onUpdate:modelValue":u[1]||(u[1]=t=>P(U)?U.value=t:null),identifier:"announcePlfStart"},{default:m(()=>[r("span",null,[c("'Start' "),a(D)?(i(),v("b",Se,"extra")):A("",!0),c(" omroepen bij 4DX")])]),_:1},8,["modelValue"])):A("",!0),a(U)&&a(g).table.some(t=>{var _;return(_=t.AUDITORIUM)==null?void 0:_.includes("4DX")})?(i(),G(F,{key:1,modelValue:a(x),"onUpdate:modelValue":u[2]||(u[2]=t=>P(x)?x.value=t:null),modelModifiers:{number:!0},identifier:"announcePlfStartGracePeriod",min:"0",max:"30",unit:"min"},{default:m(()=>[c(" Voorlooptijd 'start' bij 4DX "),a(d)>0?(i(),v("div",Ve," De 4DX-inloop wordt "+f(a(x))+" min van tevoren omgeroepen. ",1)):A("",!0)]),_:1},8,["modelValue"])):A("",!0),T(L,{modelValue:a(I),"onUpdate:modelValue":u[3]||(u[3]=t=>P(I)?I.value=t:null),identifier:"announceMainShow"},{default:m(()=>[c(" 'Start hoofdfilm' omroepen ")]),_:1},8,["modelValue"]),T(L,{modelValue:a(y),"onUpdate:modelValue":u[4]||(u[4]=t=>P(y)?y.value=t:null),identifier:"announceCredits"},{default:m(()=>[c(" 'Aftiteling' omroepen ")]),_:1},8,["modelValue"]),a(y)?(i(),G(F,{key:2,modelValue:a(d),"onUpdate:modelValue":u[5]||(u[5]=t=>P(d)?d.value=t:null),modelModifiers:{number:!0},identifier:"announceCreditsGracePeriod",step:"15",min:"0",max:"240",unit:"s"},{default:m(()=>[c(" Voorlooptijd 'aftiteling' "),a(d)>0?(i(),v("div",De," De aftiteling wordt "+f(a(d))+" s van tevoren omgeroepen. ",1)):A("",!0)]),_:1},8,["modelValue"])):A("",!0),T(L,{modelValue:a(p),"onUpdate:modelValue":u[6]||(u[6]=t=>P(p)?p.value=t:null),identifier:"announceEnd"},{default:m(()=>[c(" 'Einde voorstelling' omroepen ")]),_:1},8,["modelValue"])]),_:1}),T(a(q),{value:"Handmatig"},{default:m(()=>[r("div",Ue,[(i(),v(O,null,N(l,(t,_)=>T(j,{onClick:z=>a(S).push({id:_})},{default:m(()=>[c(f(b(_)),1)]),_:2},1032,["onClick"])),64))]),r("div",xe,[(i(!0),v(O,null,N(a(S),t=>(i(),v("div",null,[T(o,{fill:!0},{default:m(()=>[c("graphic_eq")]),_:1}),c(" "+f(b(t.id)),1)]))),256))])]),_:1})]),_:1})])])])])}}},Ae=Z(Ie,[["__scopeId","data-v-a7b588c7"]]);export{Ae as default};
