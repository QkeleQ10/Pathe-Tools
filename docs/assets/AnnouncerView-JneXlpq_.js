const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/howler-BXccDGgb.js","assets/_commonjsHelpers-C4iS2aBk.js"])))=>i.map(i=>d[i]);
import{r as k,y as Y,z as Z,u as a,A as w,_ as ee,B as ne,o as i,c as v,e as _,d as m,F as R,g as N,f as b,w as f,i as Q,x as j,j as $,t as p,m as B,l as r,p as A,q as te,s as ae,C as ue,h as le}from"./index-DuLGWUez.js";import{a as oe,u as I,_ as se,b as ie,c as ce}from"./TmsScheduleUploadSection-Db6PIFP4.js";import{_ as de}from"./Chip-ByaJpoOp.js";import{C as J,x as re}from"./super-vue3-tabs-BlFrWSWi.js";function me(D,{volume:T=1,playbackRate:g=1,soundEnabled:M=!0,interrupt:U=!1,autoplay:x=!1,onload:S,...E}={}){const h=k(null),d=k(!1),V=k(null),l=k(null);function C(){var s;typeof S=="function"&&S.call(this),V.value=(V.value||((s=l.value)==null?void 0:s.duration())||0)*1e3,x===!0&&(d.value=!0)}return Y(async()=>{const s=await Z(()=>import("./howler-BXccDGgb.js").then(L=>L.h),__vite__mapDeps([0,1]));h.value=s.default.Howl,l.value=new h.value({src:a(D),volume:a(T),rate:a(g),onload:C,...E})}),w(()=>[D],()=>{h.value&&h.value&&l&&l.value&&(l.value=new h.value({src:a(D),volume:a(T),rate:a(g),onload:C,...E}))}),w(()=>[a(T),a(g)],()=>{l.value&&(l.value.volume(a(T)),l.value.rate(a(g)))}),{play:s=>{typeof s>"u"&&(s={}),!(!l.value||!M&&!s.forceSoundEnabled)&&(U&&l.value.stop(),s.playbackRate&&l.value.rate(s.playbackRate),l.value.play(s.id),l.value.once("end",()=>{l.value&&l.value&&!l.value.playing()&&(d.value=!1)}),d.value=!0)},sound:l,isPlaying:d,duration:V,pause:s=>{l.value&&(l.value.pause(typeof s=="number"?s:void 0),d.value=!1)},stop:s=>{l.value&&(l.value.stop(typeof s=="number"?s:void 0),d.value=!1)}}}const fe="/Pathe-Tools/assets/tts-C0QUyqqz.ogg",pe=D=>(te("data-v-327ffb23"),D=D(),ae(),D),ve={class:"container dark"},he={class:"flex",style:{"flex-wrap":"wrap"}},_e={key:0,style:{flex:"50% 1 1"}},Te=pe(()=>m("h2",null,"Geplande omroepen",-1)),ge={id:"upcoming-announcements",class:"flex",style:{"flex-direction":"column",gap:"8px"}},ye={class:"room"},Se={class:"title"},Ve={class:"time"},De={class:"flex chips"},Ue=["onDblclick"],xe={id:"parameters",style:{flex:"229px 1 1"}},Ee={key:0},Ie={key:0,class:"small"},be={key:0,class:"small"},Ae={class:"flex",style:{"flex-wrap":"wrap",gap:"8px","margin-top":"-4px"}},Ce={class:"queue"},Pe={__name:"AnnouncerView",setup(D){const T=oe(),g=k(()=>new Date);setInterval(M,1e3),M();function M(){g.value=new Date}I("announcement-voice","tts");const U=I("announce-start",!1),x=I("announce-plf-start",!0),S=I("announce-plf-start-grace-period",15),E=I("announce-main-show",!1),h=I("announce-credits",!0),d=I("announce-credits-grace-period",60),V=I("announce-end",!1);function l(t){const u={start:"start",mainshow:"start hoofdfilm",credits:"aftiteling",end:"einde voorstelling"};let n=t.match(/^(auditorium)([0-9]+)$/);return u[t]?u[t]:n?`zaal ${n[2]}`:t}const C={auditorium1:[0,1296.0090702947846],auditorium2:[3e3,1344.0136054421766],auditorium3:[6e3,1248.004535147392],auditorium4:[9e3,1368.0045351473923],auditorium5:[12e3,1488.0045351473932],auditorium6:[15e3,1440.0000000000014],auditorium7:[18e3,1488.0045351473932],credits:[21e3,1296.009070294783],end:[24e3,1728.0045351473916],mainshow:[27e3,1728.0045351473916],start:[3e4,1056.0090702947846],chime:[33e3,1616.6893424036316]},{play:G,isPlaying:q}=me(fe,{sprite:C,preload:!0,onplay:async()=>{document.dispatchEvent(new Event("announcerSoundPlay"))},onend:async()=>{document.dispatchEvent(new Event("announcerSoundEnd"))}});let y=ne([]);w(y,async t=>{if(t[0]&&!C[t[0].id]&&y.shift(),t[0]&&!q.value){const u=y[0];G(u),document.addEventListener("announcerSoundEnd",()=>{y.shift()},{once:!0})}},{deep:!0});const P=k([]);w([T,U,x,S,E,h,d,V],([t])=>s(t)),s(T);function s(t){let u=[];U.value&&t.table.forEach(n=>{var o;n.scheduledTime&&u.push({announceTime:n.scheduledTime,announcement:["chime","start",`auditorium${(o=n.AUDITORIUM)==null?void 0:o.match(/\d+/)}`],status:"unscheduled",...n})}),x.value&&t.table.filter(n=>{var o;return(o=n.AUDITORIUM)==null?void 0:o.includes("4DX")}).forEach(n=>{var o;n.scheduledTime&&u.push({announceTime:new Date(n.scheduledTime.getTime()-S.value*6e4),announcement:["chime","start",`auditorium${(o=n.AUDITORIUM)==null?void 0:o.match(/\d+/)}`],status:"unscheduled",...n})}),E.value&&t.table.forEach(n=>{var o;n.scheduledTime&&u.push({announceTime:n.featureTime,announcement:["chime","mainshow",`auditorium${(o=n.AUDITORIUM)==null?void 0:o.match(/\d+/)}`],status:"unscheduled",...n})}),h.value&&t.table.forEach(n=>{var o;n.creditsTime&&u.push({announceTime:new Date(n.creditsTime.getTime()-d.value*1e3),announcement:["chime","credits",`auditorium${(o=n.AUDITORIUM)==null?void 0:o.match(/\d+/)}`],status:"unscheduled",...n})}),V.value&&t.table.forEach(n=>{var o;n.scheduledTime&&u.push({announceTime:n.endTime,announcement:["chime","end",`auditorium${(o=n.AUDITORIUM)==null?void 0:o.match(/\d+/)}`],status:"unscheduled",...n})}),P.value=[...P.value.filter(n=>n.status==="scheduled"),...u.filter(n=>n.announceTime>=Date.now()).sort((n,o)=>n.announceTime-o.announceTime)],M()}setInterval(L,3e4),w(P,L),L();function L(){P.value.filter(t=>t.announceTime-Date.now()<6e4&&t.status==="unscheduled").forEach(t=>{t.status="scheduled",setTimeout(()=>{t.status!=="unscheduled"&&(t.status="announcing",t.announcement.forEach(u=>{y.push({id:u})}))},t.announceTime-Date.now())})}function K(t){return t<6e4?Math.floor(t/1e3)+" s":t<6e5?Math.floor(t/6e4)+":"+String(Math.floor(t%6e4/1e3)).padStart(2,"0")+" min":t<36e5?Math.floor(t/6e4)+" min":Math.floor(t/36e5)+":"+String(Math.floor(t%36e5/6e4)).padStart(2,"0")+" h"}return(t,u)=>{const n=se,o=de,z=ue,O=ie,H=ce,W=le;return i(),v("div",ve,[_(n),m("section",null,[m("div",he,[a(T).table.length>0?(i(),v("div",_e,[Te,m("div",ge,[(i(!0),v(R,null,N(P.value,e=>Q((i(),v("div",{class:$(["film",{announcing:e.status==="announcing"}])},[m("div",ye,p(e.AUDITORIUM==="PULR 8"?"RT":e.AUDITORIUM.replace(/^\w+\s/,"")),1),m("div",Se,p(e.title),1),m("div",Ve,p(e.scheduledTime.toLocaleTimeString("nl-NL"))+" – "+p(e.endTime.toLocaleTimeString("nl-NL")),1),m("div",De,[(i(!0),v(R,null,N(e.extras,c=>(i(),B(o,{class:$({"translucent-white":!(c==="4DX"&&e.announcement.includes("start"))})},{default:f(()=>[r(p(c),1)]),_:2},1032,["class"]))),256))]),m("div",{class:$(["announcement",e.announcement]),onDblclick:c=>e.announcement.forEach(X=>{a(y).push({id:X})}),style:{display:"grid","grid-template-columns":"64px 130px 1fr"}},[_(z,{style:{"justify-self":"center",opacity:"0.5"},class:$({pulsate:e.status==="scheduled"})},{default:f(()=>[r(p(e.announceTime<=g.value?"graphic_eq":"schedule"),1)]),_:2},1032,["class"]),m("div",null,p(e.announceTime.toLocaleTimeString("nl-NL"))+" ("+p(K(e.announceTime-g.value))+") ",1),m("div",null,[r(" '"),(i(!0),v(R,null,N(e.announcement,(c,X)=>{var F;return Q((i(),v("span",{class:$(["word",{announcing:e.announceTime<=g.value&&((F=a(y)[0])==null?void 0:F.id)===c}])},p(l(c))+p(X<e.announcement.length-1?" ":""),3)),[[j,c!=="chime"]])}),256)),r("' ")])],42,Ue)],2)),[[j,g.value-e.announceTime<1e4]])),256))])])):b("",!0),m("div",xe,[_(a(re),{themeColor:"#ffc426"},{default:f(()=>[_(a(J),{value:"Opties"},{default:f(()=>[_(O,{modelValue:a(U),"onUpdate:modelValue":u[0]||(u[0]=e=>A(U)?U.value=e:null),identifier:"announceStart"},{default:f(()=>[r(" 'Start' omroepen ")]),_:1},8,["modelValue"]),a(T).table.some(e=>{var c;return(c=e.AUDITORIUM)==null?void 0:c.includes("4DX")})?(i(),B(O,{key:0,modelValue:a(x),"onUpdate:modelValue":u[1]||(u[1]=e=>A(x)?x.value=e:null),identifier:"announcePlfStart"},{default:f(()=>[m("span",null,[r("'Start' "),a(U)?(i(),v("b",Ee,"extra")):b("",!0),r(" omroepen bij 4DX")])]),_:1},8,["modelValue"])):b("",!0),a(x)&&a(T).table.some(e=>{var c;return(c=e.AUDITORIUM)==null?void 0:c.includes("4DX")})?(i(),B(H,{key:1,modelValue:a(S),"onUpdate:modelValue":u[2]||(u[2]=e=>A(S)?S.value=e:null),modelModifiers:{number:!0},identifier:"announcePlfStartGracePeriod",min:"0",max:"30",unit:"min"},{default:f(()=>[r(" Voorlooptijd 'start' bij 4DX "),a(d)>0?(i(),v("div",Ie," De 4DX-inloop wordt "+p(a(S))+" min van tevoren omgeroepen. ",1)):b("",!0)]),_:1},8,["modelValue"])):b("",!0),_(O,{modelValue:a(E),"onUpdate:modelValue":u[3]||(u[3]=e=>A(E)?E.value=e:null),identifier:"announceMainShow"},{default:f(()=>[r(" 'Start hoofdfilm' omroepen ")]),_:1},8,["modelValue"]),_(O,{modelValue:a(h),"onUpdate:modelValue":u[4]||(u[4]=e=>A(h)?h.value=e:null),identifier:"announceCredits"},{default:f(()=>[r(" 'Aftiteling' omroepen ")]),_:1},8,["modelValue"]),a(h)?(i(),B(H,{key:2,modelValue:a(d),"onUpdate:modelValue":u[5]||(u[5]=e=>A(d)?d.value=e:null),modelModifiers:{number:!0},identifier:"announceCreditsGracePeriod",step:"15",min:"0",max:"240",unit:"s"},{default:f(()=>[r(" Voorlooptijd 'aftiteling' "),a(d)>0?(i(),v("div",be," De aftiteling wordt "+p(a(d))+" s van tevoren omgeroepen. ",1)):b("",!0)]),_:1},8,["modelValue"])):b("",!0),_(O,{modelValue:a(V),"onUpdate:modelValue":u[6]||(u[6]=e=>A(V)?V.value=e:null),identifier:"announceEnd"},{default:f(()=>[r(" 'Einde voorstelling' omroepen ")]),_:1},8,["modelValue"])]),_:1}),_(a(J),{value:"Handmatig"},{default:f(()=>[m("div",Ae,[(i(),v(R,null,N(C,(e,c)=>_(W,{onClick:X=>a(y).push({id:c})},{default:f(()=>[r(p(l(c)),1)]),_:2},1032,["onClick"])),64))]),m("div",Ce,[(i(!0),v(R,null,N(a(y),e=>(i(),v("div",null,[_(z,{fill:!0},{default:f(()=>[r("graphic_eq")]),_:1}),r(" "+p(l(e.id)),1)]))),256))])]),_:1})]),_:1})])])])])}}},Re=ee(Pe,[["__scopeId","data-v-327ffb23"]]);export{Re as default};
