var _e=Object.defineProperty;var ve=(n,u,d)=>u in n?_e(n,u,{enumerable:!0,configurable:!0,writable:!0,value:d}):n[u]=d;var P=(n,u,d)=>ve(n,typeof u!="symbol"?u+"":u,d);import{_ as ee,a as ue}from"./server-DdQFNliv.js";import{b as re,c as we,_ as Ve,a as Te}from"./InputNumber-BQL4G3Au.js";import{d as z,A as X,B as F,c as y,F as B,q as E,h as x,g as m,w as r,a as Q,b as s,C as te,l as g,D as he,T as le,k as R,y as oe,o as a,j as O,u as $,_ as J,m as de,E as be,r as H,s as W,G as ae,H as Se,i as Oe,I as ke,J as $e,p as Z,f as Y,v as xe}from"./index-C5ES1AEp.js";import{I as me,u as Ue,_ as Ne}from"./TimetableUploadSection-DKCh8rrd.js";import{_ as Me}from"./Chip-DBSBR3Ii.js";import{u as K,a as Ce}from"./FileUploadBlock-BvVb1z_4.js";import"./nl-CmXxS_wI.js";const De="/Pathe-Tools/assets/rosetta-Cn53EfYD.ogg",Ae="/Pathe-Tools/assets/gerwim-CqHIXSuO.ogg",Be="/Pathe-Tools/assets/jaron-CS_9Sx9l.ogg",Ee="/Pathe-Tools/assets/danique-C_bjxFfD.ogg";class G{constructor(u){P(this,"name");P(this,"language");P(this,"file");P(this,"sprite");this.name=u.name,this.language=u.language,this.file=u.file,this.sprite=u.sprite}get sounds(){return Object.keys(this.sprite)}get additionalSounds(){return this.sounds.filter(u=>!A.default.sounds.includes(u))}}const A={default:new G({name:"Rosetta",language:"nl",file:De,sprite:{auditorium01:[0,937.0294784580499],auditorium02:[1200,982.9931972789117],auditorium03:[2400,863.6281179138323],auditorium04:[3600,1022.8571428571427],auditorium05:[5800,1023.1065759637188],auditorium06:[8e3,1016.2585034013603],auditorium07:[10200,1187.2335600907036],auditorium08:[12400,1109.2290249433106],auditorium09:[14600,1185.2154195011337],auditorium10:[16800,959.9773242630398],auditorium11:[18000.000000000004,1122.6077097505681],auditorium12:[20200.000000000004,1185.8049886621309],auditorium13:[22400.000000000004,1159.6825396825388],auditorium14:[24600,1169.5918367346926],auditorium15:[26800,1240.1360544217682],auditorium16:[29e3,1161.0884353741503],auditorium17:[31200,1213.2426303854907],auditorium18:[33400.00000000001,1123.990929705215],auditorium19:[35600.00000000001,1342.7664399092976],auditorium20:[37800.000000000015,1263.8321995464848],chime:[40000.000000000015,3084.51247165533],credits:[44200.000000000015,924.7165532879791],end:[45400.000000000015,1289.478458049885],mainshow:[47600.00000000001,1445.963718820863],preshow:[49800.000000000015,1364.3990929705226],start:[52000.000000000015,686.9841269841288]}}),gerwim:new G({name:"Gerwim",language:"nl",file:Ae,sprite:{auditorium01:[0,824.9659863945578],auditorium02:[1200,870.907029478458],auditorium03:[2400,790.2040816326532],auditorium04:[3600,886.825396825397],auditorium05:[4800,838.526077097506],auditorium06:[6e3,866.7573696145121],auditorium07:[7199.999999999999,987.7777777777776],auditorium10:[8399.999999999998,665.6689342403635],credits:[9600,936.5532879818588],start:[10799.999999999998,638.9342403628114]}}),jaron:new G({name:"Jaron",language:"nl",file:Be,sprite:{auditorium01:[0,996.2585034013606],auditorium02:[1200,977.2562358276645],auditorium03:[2400,1053.9229024943313],auditorium04:[4600,1109.8866213151925],auditorium05:[6799.999999999999,1125.5328798185947],auditorium06:[9e3,1083.7641723356005],auditorium07:[11200,1070.2947845804988],auditorium08:[13399.999999999998,1134.9206349206345],auditorium09:[15599.999999999998,1259.2517006802736],auditorium10:[17800,750.5895691609971],credits:[19e3,920.6575963718819],end:[20200,1177.0748299319714],finalshow:[22400,1377.0068027210875],mainshow:[24599.999999999996,1302.0634920634925],start:[26799.999999999996,737.8458049886625]}}),danique:new G({name:"Danique",language:"nl",file:Ee,sprite:{auditorium01:[0,737.9591836734694],auditorium02:[1200,820.340136054422],auditorium03:[2400.0000000000005,677.482993197279],auditorium04:[3600.0000000000005,822.6530612244902],auditorium05:[4800.000000000001,810.5442176870747],auditorium06:[6000.000000000001,795.4875283446717],auditorium07:[7200.000000000001,926.8027210884355],auditorium08:[8400,871.0430839002274],auditorium09:[9600.000000000002,941.8820861677997],auditorium10:[10800,689.569160997733],credits:[12000.000000000002,786.3718820861685],end:[13200.000000000004,1149.2743764172335],start:[15400.000000000002,520.2040816326523]}})};function q(n){const u={start:"start",mainshow:"start hoofdfilm",credits:"aftiteling",end:"einde voorstelling",preshow:"start voorprogramma",finalshow:"laatste voorstelling",chime:"♪"};n=n.toLowerCase().trim();let d=n.replace(/\?+/g,""),_=u[d]||d,v=Object.values(A).some(e=>e.sounds.includes(d)),b=1/Math.pow(2,(n.match(/\?+/g)||[""])[0].length);n.includes("|")&&(_=n.split("|").map(e=>q(e).name).join("|"),v=_.split("|").every(e=>e!==d),b=1);let k=d.match(/^(auditorium)([0-9]+|(#))$/);return k&&(_=`zaal ${k[2]=="#"?"#":Number(k[2])}`,v=!0),{id:d,name:_,valid:v,probability:b}}const Ie={key:0,class:"segment-list"},Re=["value"],je={key:1},Le={class:"flex",style:{"margin-top":"16px"}},Pe=z({__name:"AnnouncementBuilder",props:X({noButton:{type:Boolean,default:!1},playButton:{type:Boolean,default:!1}},{modelValue:{},modelModifiers:{},show:{type:Boolean,default:!1},showModifiers:{}}),emits:X(["play"],["update:modelValue","update:show"]),setup(n,{emit:u}){const d=F(n,"modelValue"),_=F(n,"show"),v=u,b=[...new Set(Object.values(A).flatMap(o=>o.sounds))];function k(){d.value.push({spriteName:"",offset:0})}function e(o){return o.charAt(0).toUpperCase()+o.slice(1)}return(o,i)=>{const h=te,V=oe,U=ue,D=re,I=ee;return a(),y(B,null,[n.noButton?x("",!0):(a(),E(V,he({key:0,class:"secondary announcement-builder-button",onClick:i[0]||(i[0]=C=>_.value=!0)},o.$attrs),{default:r(()=>[Q(o.$slots,"default",{},()=>[m(h,null,{default:r(()=>i[3]||(i[3]=[g("build")])),_:1,__:[3]}),i[4]||(i[4]=s("span",null,"Omroep bewerken",-1))],!0)]),_:3},16)),m(le,null,{default:r(()=>[_.value?(a(),E(I,{key:0,onDismiss:i[2]||(i[2]=C=>_.value=!1)},{default:r(()=>[i[10]||(i[10]=s("h3",null,"Omroeponderdelen",-1)),d.value.length?(a(),y("ul",Ie,[(a(!0),y(B,null,R(d.value,(C,l)=>(a(),y("li",{class:"segment",key:l},[m(U,{class:"no-label",identifier:"spriteName"+l,modelValue:C.spriteName,"onUpdate:modelValue":M=>C.spriteName=M,spellcheck:"false",autocomplete:"off",autocapitalize:"off"},{datalist:r(()=>[(a(),y(B,null,R(b,M=>s("option",{key:M,value:M},O(e($(q)(M).name)),9,Re)),64))]),_:2},1032,["identifier","modelValue","onUpdate:modelValue"]),m(D,{class:"no-label",identifier:"offset"+l,modelValue:C.offset,"onUpdate:modelValue":M=>C.offset=M,unit:"ms"},null,8,["identifier","modelValue","onUpdate:modelValue"]),m(h,{style:{float:"right",cursor:"pointer",padding:"2px"},onClick:M=>d.value.splice(l,1)},{default:r(()=>i[5]||(i[5]=[g(" delete")])),_:2,__:[5]},1032,["onClick"])]))),128))])):(a(),y("p",je," Geen onderdelen gevonden. ")),s("div",Le,[m(V,{class:"secondary add-rule",onClick:k},{default:r(()=>[m(h,null,{default:r(()=>i[6]||(i[6]=[g("add")])),_:1,__:[6]}),i[7]||(i[7]=g(" Nieuw onderdeel "))]),_:1,__:[7]}),n.playButton?(a(),E(V,{key:0,class:"secondary add-rule",onClick:i[1]||(i[1]=C=>v("play"))},{default:r(()=>[m(h,null,{default:r(()=>i[8]||(i[8]=[g("play_arrow")])),_:1,__:[8]}),i[9]||(i[9]=g(" Afspelen "))]),_:1,__:[9]})):x("",!0)])]),_:1,__:[10]})):x("",!0)]),_:1})],64)}}}),pe=J(Pe,[["__scopeId","data-v-74e20feb"]]),He=["for"],Fe={class:"title"},qe=["id"],ze=z({__name:"InputSelect",props:X({identifier:{}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(n){const u=F(n,"modelValue");return(d,_)=>(a(),y("label",{class:"input select-input",for:d.identifier},[s("div",Fe,[Q(d.$slots,"default",{},void 0,!0)]),de(s("select",{id:d.identifier,"onUpdate:modelValue":_[0]||(_[0]=v=>u.value=v)},[Q(d.$slots,"options",{},void 0,!0)],8,qe),[[be,u.value]])],8,He))}}),Ge=J(ze,[["__scopeId","data-v-15be24ca"]]),Xe={key:1,class:"input timing-input"},We=["value"],Je={key:2},Ze={style:{opacity:".5"}},Ye={key:0},Ke={key:1},Qe={key:2},et={style:{opacity:".5"}},tt={key:0,style:{opacity:".5"}},lt={key:0},ot={key:1},nt={key:2},it={key:3},st={key:4},at={key:1,style:{opacity:".5"}},ut={key:1},rt=z({__name:"RuleList",props:X({toggleOnly:{type:Boolean,default:!1}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(n){const u=H(!1),d=H(!1),_=F(n,"modelValue"),v={scheduledTime:"inloop",showTime:"start",mainShowTime:"start hoofdfilm",creditsTime:"aftiteling",endTime:"einde voorstelling"};function b(){const k={id:Date.now().toString(),enabled:!0,segments:[{spriteName:"chime",offset:-800},{spriteName:"auditorium#",offset:0}],trigger:{property:"scheduledTime",preponeMinutes:0},filter:{plfOnly:!1,lastShowOnly:!1,firstShowOnly:!1,playlistTitleIncludes:"",playlistTitleExcludes:""}};_.value.push(k)}return(k,e)=>{const o=te,i=me,h=re,V=Ge,U=pe,D=ue,I=ee,C=oe;return a(),y(B,null,[_.value.length?(a(),y("ul",{key:0,class:W(["rule-list",{"toggle-only":n.toggleOnly}])},[(a(!0),y(B,null,R(_.value,(l,M)=>(a(),y("li",{class:W(["rule",{active:l.enabled}]),key:l.id},[n.toggleOnly?x("",!0):(a(),E(o,{key:0,style:{float:"right",cursor:"pointer",padding:"2px"},onClick:p=>_.value.splice(M,1)},{default:r(()=>e[4]||(e[4]=[g(" delete")])),_:2,__:[4]},1032,["onClick"])),m(i,{class:"toggler",identifier:l.id+"enabled",modelValue:l.enabled,"onUpdate:modelValue":p=>l.enabled=p},{default:r(()=>[g(O(l.name||"Eigen regel"),1)]),_:2},1032,["identifier","modelValue","onUpdate:modelValue"]),n.toggleOnly?(a(),y("p",Je,[e[10]||(e[10]=g(" Timing: ")),s("span",Ze,[l.trigger.preponeMinutes>0?(a(),y("span",Ye,[s("b",null,O(l.trigger.preponeMinutes)+" min.",1),e[7]||(e[7]=g(" vóór"))])):l.trigger.preponeMinutes<0?(a(),y("span",Ke,[s("b",null,O(-l.trigger.preponeMinutes)+" min.",1),e[8]||(e[8]=g(" na"))])):(a(),y("span",Qe,"bij")),e[9]||(e[9]=g()),s("b",null,O(v[l.trigger.property]),1)])])):(a(),y("div",Xe,[e[6]||(e[6]=s("span",null,"Timing:",-1)),s("span",null,[m(h,{class:"no-label",identifier:l.id+"triggerPreponeMinutes",unit:"min.",modelValue:l.trigger.preponeMinutes,"onUpdate:modelValue":p=>l.trigger.preponeMinutes=p},null,8,["identifier","modelValue","onUpdate:modelValue"]),e[5]||(e[5]=g(" vóór ")),m(V,{class:"no-label",identifier:l.id+"triggerProperty",modelValue:l.trigger.property,"onUpdate:modelValue":p=>l.trigger.property=p},{options:r(()=>[(a(),y(B,null,R(v,(p,f)=>s("option",{key:f,value:f},O(p),9,We)),64))]),_:2},1032,["identifier","modelValue","onUpdate:modelValue"])])])),s("a",{onClick:e[0]||(e[0]=()=>{n.toggleOnly||(u.value=!0)})},[e[11]||(e[11]=s("u",null,"Omroep",-1)),e[12]||(e[12]=g(": ")),s("span",et,O(l.segments.map(p=>$(q)(p.spriteName).name).join(" - ")),1)]),m(U,{"no-button":"",modelValue:l.segments,"onUpdate:modelValue":p=>l.segments=p,show:u.value,"onUpdate:show":e[1]||(e[1]=p=>u.value=p)},{default:r(()=>[m(o,null,{default:r(()=>e[13]||(e[13]=[g("build")])),_:1,__:[13]}),s("span",null,O(l.segments.map(p=>$(q)(p.spriteName).name).join(" - ")),1)]),_:2},1032,["modelValue","onUpdate:modelValue","show"]),e[27]||(e[27]=s("br",null,null,-1)),!n.toggleOnly||Object.values(l.filter).some(p=>typeof p=="string"?p.length>0:p)?(a(),y("a",{key:3,onClick:e[2]||(e[2]=()=>{n.toggleOnly||(d.value=!0)})},[e[19]||(e[19]=s("u",null,"Filter",-1)),e[20]||(e[20]=g(": ")),Object.values(l.filter).some(p=>typeof p=="string"?p.length>0:p)?(a(),y("span",tt,[e[18]||(e[18]=g(" alleen ")),l.filter.lastShowOnly?(a(),y("b",lt,"de laatste ")):x("",!0),l.filter.firstShowOnly?(a(),y("b",ot,"de eerste ")):x("",!0),l.filter.plfOnly?(a(),y("b",nt,"4DX-")):x("",!0),g("voorstelling"+O(l.filter.lastShowOnly||l.filter.firstShowOnly?"":"en")+" ",1),l.filter.playlistTitleIncludes?(a(),y("span",it,[e[14]||(e[14]=g("met ")),s("b",null,O(l.filter.playlistTitleIncludes),1),e[15]||(e[15]=g(" in de titel "))])):x("",!0),l.filter.playlistTitleExcludes?(a(),y("span",st,[e[16]||(e[16]=g("zonder ")),s("b",null,O(l.filter.playlistTitleExcludes),1),e[17]||(e[17]=g(" in de titel "))])):x("",!0)])):(a(),y("span",at,"elke voorstelling"))])):x("",!0),m(le,null,{default:r(()=>[d.value?(a(),E(I,{key:0,onDismiss:e[3]||(e[3]=p=>d.value=!1),class:"filters"},{default:r(()=>[e[26]||(e[26]=s("h3",null,"Filter",-1)),m(i,{identifier:l.id+"plfOnly",modelValue:l.filter.plfOnly,"onUpdate:modelValue":p=>l.filter.plfOnly=p},{default:r(()=>e[21]||(e[21]=[g(" Alleen 4DX-voorstellingen ")])),_:2,__:[21]},1032,["identifier","modelValue","onUpdate:modelValue"]),m(i,{identifier:l.id+"lastShowOnly",modelValue:l.filter.lastShowOnly,"onUpdate:modelValue":p=>l.filter.lastShowOnly=p},{default:r(()=>e[22]||(e[22]=[g(" Alleen de laatste overeenkomst ")])),_:2,__:[22]},1032,["identifier","modelValue","onUpdate:modelValue"]),m(i,{identifier:l.id+"firstShowOnly",modelValue:l.filter.firstShowOnly,"onUpdate:modelValue":p=>l.filter.firstShowOnly=p},{default:r(()=>e[23]||(e[23]=[g(" Alleen de eerste overeenkomst ")])),_:2,__:[23]},1032,["identifier","modelValue","onUpdate:modelValue"]),m(D,{identifier:l.id+"playlistTitleIncludes",modelValue:l.filter.playlistTitleIncludes,"onUpdate:modelValue":p=>l.filter.playlistTitleIncludes=p},{default:r(()=>e[24]||(e[24]=[g(" Titel moet bevatten ")])),_:2,__:[24]},1032,["identifier","modelValue","onUpdate:modelValue"]),m(D,{identifier:l.id+"playlistTitleExcludes",modelValue:l.filter.playlistTitleExcludes,"onUpdate:modelValue":p=>l.filter.playlistTitleExcludes=p},{default:r(()=>e[25]||(e[25]=[g(" Titel mag niet bevatten ")])),_:2,__:[25]},1032,["identifier","modelValue","onUpdate:modelValue"])]),_:2,__:[26]},1024)):x("",!0)]),_:2},1024)],2))),128))],2)):(a(),y("p",ut," Geen regels gevonden. ")),n.toggleOnly?x("",!0):(a(),E(C,{key:2,class:"secondary add-rule",onClick:b},{default:r(()=>[m(o,null,{default:r(()=>e[28]||(e[28]=[g("add")])),_:1,__:[28]}),e[29]||(e[29]=g(" Nieuwe regel "))]),_:1,__:[29]}))],64)}}}),dt=J(rt,[["__scopeId","data-v-b1e49e68"]]),mt=z({__name:"VoicesSelector",props:{modelValue:{default:["default"]},modelModifiers:{}},emits:["update:modelValue"],setup(n){const u=F(n,"modelValue");function d(_,v){if(_)u.value.push(v);else{const b=u.value.indexOf(v);b>-1&&u.value.splice(b,1)}}return(_,v)=>{const b=me;return a(!0),y(B,null,R($(A),(k,e)=>(a(),E(b,{key:e,modelValue:u.value.includes(e),"onUpdate:modelValue":o=>d(o,e),identifier:e},{default:r(()=>[g(O(k.name),1)]),_:2},1032,["modelValue","onUpdate:modelValue","identifier"]))),128)}}});function pt(n){const u=n.numberOfChannels,d=n.sampleRate,_=16,v=u*(_/8),b=d*v,k=new ArrayBuffer(44+n.length*v),e=new DataView(k);let o=0;function i(h){for(let V=0;V<h.length;V++)e.setUint8(o++,h.charCodeAt(V))}i("RIFF"),e.setUint32(o,36+n.length*v,!0),o+=4,i("WAVE"),i("fmt "),e.setUint32(o,16,!0),o+=4,e.setUint16(o,1,!0),o+=2,e.setUint16(o,u,!0),o+=2,e.setUint32(o,d,!0),o+=4,e.setUint32(o,b,!0),o+=4,e.setUint16(o,v,!0),o+=2,e.setUint16(o,_,!0),o+=2,i("data"),e.setUint32(o,n.length*v,!0),o+=4;for(let h=0;h<n.length;h++)for(let V=0;V<u;V++){const U=Math.max(-1,Math.min(1,n.getChannelData(V)[h]));e.setInt16(o,U<0?U*32768:U*32767,!0),o+=2}return new Blob([e],{type:"audio/wav"})}async function ft(n){const u=new AudioContext,d=new Map;for(const{voice:o}of n)if(!d.has(o)){const h=await(await fetch(o.file)).arrayBuffer(),V=await u.decodeAudioData(h);d.set(o,V)}let _=0,v=0;for(let o=0;o<n.length;o++){const i=n[o],[h,V]=i.voice.sprite[i.spriteName]||[0,0],U=_+V/1e3;U>v&&(v=U),_+=(V+(i.offset||0))/1e3}const b=new OfflineAudioContext(2,Math.ceil(v*44100),44100);_=0;for(let o=0;o<n.length;o++){const i=n[o],[h,V]=i.voice.sprite[i.spriteName]||[0,0],U=d.get(i.voice);if(!U)return;const D=b.createBufferSource();D.buffer=U;const I=Math.max(0,_);D.start(I,h/1e3,V/1e3),D.connect(b.destination),_+=(V+(i.offset||0))/1e3}const k=await b.startRendering(),e=pt(k);return URL.createObjectURL(e)}const gt={class:"flex",style:{"flex-wrap":"wrap-reverse"}},ct={style:{flex:"50% 1 1"}},yt={id:"upcoming-announcements"},_t={class:"room"},vt={class:"title"},wt={class:"time"},Vt={class:"flex chips"},Tt=["onDblclick"],ht={key:"0"},bt={key:1},St={style:{position:"relative"}},Ot={key:0},kt={key:0,class:"dropzone"},$t=z({__name:"AnnouncerView",setup(n){const u=Ue(),d=ke("now"),_=ae("main"),v=ae("audios"),b=H(!1),k=K("default-rules",[{id:"plfStart",name:"4DX-inloop",segments:[{spriteName:"chime",offset:-800},{spriteName:"start",offset:0},{spriteName:"auditorium#",offset:0}],enabled:!0,trigger:{property:"scheduledTime",preponeMinutes:15},filter:{plfOnly:!0,lastShowOnly:!1,firstShowOnly:!1,playlistTitleIncludes:"",playlistTitleExcludes:""}},{id:"start",name:"Start",segments:[{spriteName:"chime",offset:-800},{spriteName:"start",offset:0},{spriteName:"auditorium#",offset:0}],enabled:!1,trigger:{property:"scheduledTime",preponeMinutes:0},filter:{plfOnly:!1,lastShowOnly:!1,firstShowOnly:!1,playlistTitleIncludes:"",playlistTitleExcludes:""}},{id:"mainShow",name:"Start hoofdfilm",segments:[{spriteName:"chime",offset:-800},{spriteName:"mainshow",offset:0},{spriteName:"auditorium#",offset:0}],enabled:!1,trigger:{property:"mainShowTime",preponeMinutes:0},filter:{plfOnly:!1,lastShowOnly:!1,firstShowOnly:!1,playlistTitleIncludes:"",playlistTitleExcludes:""}},{id:"credits",name:"Aftiteling",segments:[{spriteName:"chime",offset:-800},{spriteName:"credits",offset:0},{spriteName:"auditorium#",offset:0}],enabled:!0,trigger:{property:"creditsTime",preponeMinutes:1},filter:{plfOnly:!1,lastShowOnly:!1,firstShowOnly:!1,playlistTitleIncludes:"",playlistTitleExcludes:""}},{id:"end",name:"Einde voorstelling",segments:[{spriteName:"chime",offset:-800},{spriteName:"end",offset:0},{spriteName:"auditorium#",offset:0}],enabled:!1,trigger:{property:"endTime",preponeMinutes:0},filter:{plfOnly:!1,lastShowOnly:!1,firstShowOnly:!1,playlistTitleIncludes:"",playlistTitleExcludes:""}},{id:"finalMainShowStart",name:"Start laatste hoofdfilm",segments:[{spriteName:"chime",offset:-800},{spriteName:"finalshow",offset:0}],enabled:!1,trigger:{property:"mainShowTime",preponeMinutes:0},filter:{plfOnly:!1,lastShowOnly:!0,firstShowOnly:!1,playlistTitleIncludes:"",playlistTitleExcludes:""}}],localStorage,{mergeDefaults:!0}),e=K("custom-rules",[],localStorage,{mergeDefaults:!0}),o=K("preferred-voices",["default"],localStorage,{mergeDefaults:!0}),i=H([{spriteName:"chime",offset:-800}]),h=H([]);u.$subscribe(V,{deep:!0}),Se(()=>{V(),setInterval(U,1e4)});function V(){v.value.innerHTML="";let f=[];for(const t of[...k.value,...e.value]){if(!t.enabled)continue;let w=[];u.table.forEach((T,N)=>{if(D(T,N,t.filter)){const S={time:new Date(T[t.trigger.property].getTime()-(t.trigger.preponeMinutes||0)*6e4-5e3),show:T,segments:t.segments.map(j=>({...j,spriteName:j.spriteName.replace("#",`${String(T.auditoriumNumber).padStart(2,"0")}`)})),audio:null};S.time.getTime()>Date.now()&&w.push(S)}}),w.sort((T,N)=>T.time.getTime()-N.time.getTime()),t.filter.firstShowOnly&&(w=w.slice(0,1)),t.filter.lastShowOnly&&(w=w.slice(-1)),f.push(...w)}h.value=f.sort((t,w)=>t.time.getTime()-w.time.getTime()),U()}async function U(){for(const f of h.value){const t=f.time.getTime()-Date.now()-1e3;if(t>-1e3&&t<1e4&&!f.audio){const w=C(f.segments,o.value.map(T=>A[T]));f.audio=await l(w),v.value.appendChild(f.audio),setTimeout(()=>{var N;const T=Array.from(v.value.children).find(S=>S!==f.audio&&!S.paused);T?T.addEventListener("ended",()=>{var S;(S=f.audio)==null||S.play()},{once:!0}):(N=f.audio)==null||N.play()},Math.max(0,t))}}}function D(f,t,w){let T=!0;return w.plfOnly&&!f.auditorium.includes("4DX")&&(T=!1),w.playlistTitleIncludes&&!f.title.toLowerCase().includes(w.playlistTitleIncludes.toLowerCase())&&(T=!1),w.playlistTitleExcludes&&f.title.toLowerCase().includes(w.playlistTitleExcludes.toLowerCase())&&(T=!1),T}function I(f){return f<6e4?Math.floor(f/1e3)+" s":f<6e5?Math.floor(f/6e4)+":"+String(Math.floor(f%6e4/1e3)).padStart(2,"0")+" min":f<36e5?Math.floor(f/6e4)+" min":Math.floor(f/36e5)+":"+String(Math.floor(f%36e5/6e4)).padStart(2,"0")+" h"}function C(f,t){const w=t.sort(()=>.5-Math.random()),T=Object.values(A);for(const N of w)if(f.every(S=>S.spriteName==="chime"||N.sprite[S.spriteName]))return f.map(S=>({...S,voice:S.spriteName==="chime"?A.default:N}));return f.map(N=>{const S=[...w,...T].find(j=>j.sprite[N.spriteName]);return{...N,voice:(N.spriteName==="chime"?A.default:S)||A.default}})}function l(f){return new Promise(async t=>{const w=await ft(f),T=new Audio(w);T.addEventListener("ended",()=>{T.remove()}),t(T)})}async function M(f,t=o.value.map(w=>A[w])){const w=C(f,t);(await l(w)).play()}const{isOverDropZone:p}=Ce(_,{onDrop:u.filesUploaded,multiple:!1});return(f,t)=>{const w=Oe,T=Ne,N=Me,S=te,j=mt,fe=pe,ne=oe,ge=we,ie=dt,se=Te,ce=Ve,ye=ee;return a(),y("main",{ref_key:"main",ref:_},[m(w),m(T),s("section",null,[s("div",gt,[s("div",ct,[t[9]||(t[9]=s("h2",null,"Geplande omroepen",-1)),s("div",yt,[m($e,{name:"list"},{default:r(()=>[(a(!0),y(B,null,R(h.value,c=>de((a(),y("div",{class:W(["film",{announcing:c.audio&&!c.audio.paused}]),key:c.time.getTime()},[s("div",_t,O(c.show.auditorium==="PULR 8"||c.show.auditorium==="Rooftop"?"RT":c.show.auditorium.replace(/^\w+\s/,"")),1),s("div",vt,O(c.show.title),1),s("div",wt,O($(Y)(c.show.scheduledTime,"HH:mm"))+" – "+O($(Y)(c.show.endTime,"HH:mm:ss")),1),s("div",Vt,[(a(!0),y(B,null,R(c.show.extras,L=>(a(),E(N,{class:W({"translucent-white":L.match(/\(.+\)/)})},{default:r(()=>[g(O(L.replace(/\((.+)\)/,"$1")),1)]),_:2},1032,["class"]))),256))]),s("div",{class:"announcement",onDblclick:L=>M(c.segments),style:{display:"grid","grid-template-columns":"64px 130px 1fr"}},[m(S,null,{default:r(()=>t[8]||(t[8]=[g("schedule")])),_:1,__:[8]}),s("div",null,O($(Y)(c.time,"HH:mm:ss"))+" ("+O(I(c.time.getTime()-$(d).getTime()))+") ",1),s("div",null," '"+O(c.segments.map(L=>$(q)(L.spriteName).name).join(" "))+"' ",1)],40,Tt)],2)),[[xe,c.time.getTime()-$(d).getTime()>-5e3||c.audio&&!c.audio.paused]])),128)),h.value.filter(c=>$(d).getTime()-c.time.getTime()<1e4).length<1?(a(),y("p",ht,"Er zijn geen omroepen gepland.")):x("",!0),$(u).table.length<1?(a(),y("p",bt,"Upload eerst een bestand.")):x("",!0)]),_:1})])]),m(ge,{style:{flex:"30% 1 1"}},{default:r(()=>[t[17]||(t[17]=s("h2",null,"Opties",-1)),s("fieldset",null,[t[10]||(t[10]=s("legend",null,"Stemmen",-1)),m(j,{modelValue:$(o),"onUpdate:modelValue":t[0]||(t[0]=c=>Z(o)?o.value=c:null)},null,8,["modelValue"])]),s("fieldset",St,[t[13]||(t[13]=s("legend",null,"Handmatige omroep",-1)),m(fe,{modelValue:i.value,"onUpdate:modelValue":t[1]||(t[1]=c=>i.value=c),"play-button":"",class:"full",onPlay:t[2]||(t[2]=c=>M(i.value))},{default:r(()=>[m(S,null,{default:r(()=>t[11]||(t[11]=[g("build")])),_:1,__:[11]}),t[12]||(t[12]=s("span",null,"Omroep maken",-1))]),_:1,__:[12]},8,["modelValue"])]),s("fieldset",null,[t[16]||(t[16]=s("legend",null,"Regels",-1)),m(ne,{class:"secondary full",onClick:t[3]||(t[3]=c=>b.value=!0)},{default:r(()=>[m(S,null,{default:r(()=>t[14]||(t[14]=[g("edit")])),_:1,__:[14]}),s("span",null,[t[15]||(t[15]=g("Regels bewerken ")),$(e).filter(c=>c.enabled).length?(a(),y("small",Ot,"(eigen regels: "+O($(e).filter(c=>c.enabled).length)+" actief)",1)):x("",!0)])]),_:1})])]),_:1,__:[17]})])]),m(le,null,{default:r(()=>[b.value?(a(),E(ye,{key:0,onDismiss:t[7]||(t[7]=c=>b.value=!1)},{default:r(()=>[m(ce,null,{default:r(()=>[m(se,{value:"Standaardregels"},{default:r(()=>[m(ie,{modelValue:$(k),"onUpdate:modelValue":t[4]||(t[4]=c=>Z(k)?k.value=c:null),toggleOnly:!0},null,8,["modelValue"])]),_:1}),m(se,{value:"Eigen regels"},{default:r(()=>[m(ie,{modelValue:$(e),"onUpdate:modelValue":t[5]||(t[5]=c=>Z(e)?e.value=c:null),toggleOnly:!1},null,8,["modelValue"])]),_:1})]),_:1}),m(ne,{class:"full",onClick:t[6]||(t[6]=c=>{V(),b.value=!1}),style:{"margin-top":"16px"}},{default:r(()=>[m(S,null,{default:r(()=>t[18]||(t[18]=[g("refresh")])),_:1,__:[18]}),t[19]||(t[19]=s("span",null,"Omroepen klaarzetten",-1))]),_:1,__:[19]})]),_:1})):x("",!0)]),_:1}),$(p)?(a(),y("div",kt," Laat los om bestand te uploaden ")):x("",!0),s("div",{ref_key:"audios",ref:v,id:"audios"},null,512)],512)}}}),Et=J($t,[["__scopeId","data-v-8a05d733"]]);export{Et as default};
