import{d as ne,c as se,e as te,b as oe,a as ae,_ as le}from"./FileUploadBlock-D86B-yMi.js";import{_ as re,a as ie,b as ue}from"./InputNumber-Bv2E3bn7.js";import{M as de,r as $,H as ce,d as P,c as g,b as n,g as d,u as s,l as m,s as A,j as x,w as l,F as I,k as M,q as N,h as F,C as O,T as me,y as R,o as i,_ as G,O as pe,i as _e,K as fe,p as ge,m as ve,v as we}from"./index-DdomZHAx.js";import{u as K,h as D,a as ke,_ as be}from"./server-BVGr8SwU.js";const H=de("slideshowImages",()=>{const h=$([]),c=$("no-connection"),v=K();ce(o);async function o(){var _;for(;h.value.length;)h.value.pop();if(v.username.length>0)try{c.value="receiving";const p=await u();(_=Object.values(p))!=null&&_[0]&&h.value.push(...p),c.value="received"}catch(p){c.value="receive-error",console.error(p)}else c.value="no-connection"}async function u(){return new Promise(async(_,p)=>{try{const a=await fetch(`http://localhost:3541/users/${v.username}/pictures`,{headers:{"ngrok-skip-browser-warning":"true"}});if(!a.ok)throw new Error(`Server responded with ${a.status} ${a.statusText}`);const f=await a.json();if(!f)throw new Error("No data found");const w=await Promise.all(f.map(async r=>await e(r)));_(w)}catch(a){console.error("Error getting data from server:",a),p(a)}})}async function k(_){return new Promise(async(p,a)=>{try{c.value="sending";const f=new FormData;for(const b of _)f.append("pictures",b);const w=await fetch(`http://localhost:3541/users/${v.username}/pictures`,{method:"POST",headers:{Authorization:"Basic "+btoa(`${v.username}:${v.password}`),"ngrok-skip-browser-warning":"true"},body:f});if(!w.ok)throw new Error(`Server responded with ${w.status} ${w.statusText}`);const r=await w.json();if(!r)throw new Error("No data found");c.value="receiving",h.value=[...h.value,...await Promise.all(r.files.map(async b=>await e(b)))].sort((b,S)=>b.localeCompare(S)),c.value="sent",p()}catch(f){c.value="send-error",console.error(f),a(f)}})}async function T(){return new Promise(async(_,p)=>{try{c.value="sending";const a=await fetch(`http://localhost:3541/users/${v.username}/pictures`,{method:"DELETE",headers:{Authorization:"Basic "+btoa(`${v.username}:${v.password}`),"ngrok-skip-browser-warning":"true"}});if(!a.ok)throw new Error(`Server responded with ${a.status} ${a.statusText}`);h.value=[],c.value="sent",_()}catch(a){c.value="send-error",p(a)}})}async function e(_){const a=await(await fetch(`http://localhost:3541/users/${v.username}/pictures/${_}`,{headers:{"ngrok-skip-browser-warning":"true"}})).blob();return URL.createObjectURL(a)}return{images:h,filesUploaded:k,deleteAll:T,fetchImage:e,status:c,connect:o}}),ye={id:"upload"},he={class:"floating"},$e=["title"],Se={key:0,class:"pictures",style:{"flex-grow":"1"}},Te=["src","onClick"],Ce={key:1,style:{"flex-grow":"1"}},Ee={id:"server-options"},xe={class:"server-options-container"},Ue={class:"server-options-container"},Ve={style:{float:"right",opacity:".5"}},je=P({__name:"SlideshowUploadSection",emits:["slide-clicked"],setup(h,{emit:c}){const v=c,o=H(),u=K(),k=$(!1);return(T,e)=>{const _=O,p=R,a=ne,f=ke,w=be;return i(),g("section",ye,[n("div",he,[n("button",{id:"upload-status",onClick:e[0]||(e[0]=r=>k.value=!0),title:s(D)[s(o).status].long||s(o).status+`
Klik om serveropties te wijzigen`},[n("div",{id:"upload-status-light",class:A(s(o).status)},null,2),m(" "+x(s(D)[s(o).status].short||s(o).status),1)],8,$e)]),d(a,{onFilesUploaded:s(o).filesUploaded,accept:"image/*",multiple:""},{buttons:l(()=>{var r;return[(r=s(o).images)!=null&&r.length?(i(),N(p,{key:0,class:"secondary",onClick:s(o).deleteAll},{default:l(()=>[d(_,null,{default:l(()=>e[6]||(e[6]=[m("delete_forever")])),_:1,__:[6]}),e[7]||(e[7]=m("Alles verwijderen "))]),_:1,__:[7]},8,["onClick"])):F("",!0)]}),default:l(()=>{var r;return[(r=s(o).images)!=null&&r.length?(i(),g("div",Se,[(i(!0),g(I,null,M(s(o).images,(b,S)=>(i(),g("img",{src:b,onClick:U=>v("slide-clicked",S)},null,8,Te))),256))])):(i(),g("p",Ce,e[5]||(e[5]=[m(" Geen afbeeldingen "),n("br",null,null,-1),n("small",null,"Upload afbeeldingen met de knop of door ze hierheen te slepen.",-1)])))]}),_:1},8,["onFilesUploaded"]),d(me,null,{default:l(()=>[k.value?(i(),N(w,{key:0,onDismiss:e[4]||(e[4]=r=>k.value=!1)},{default:l(()=>[e[15]||(e[15]=n("h3",null,"Opslag op server",-1)),e[16]||(e[16]=n("p",null,[m(" Als je een geldige gebruikersnaam en wachtwoord hebt opgegeven, dan worden de door jou ingelezen afbeeldingen bewaard op de server. "),n("br"),n("br"),m(" Je kunt vervolgens later (eventueel vanaf een ander apparaat) de afbeeldingen terugzien als je daar ook je gebruikersnaam opgeeft. "),n("br"),n("br"),m(" Afbeeldingen worden gesorteerd op bestandsnaam. Er kan maar één afbeelding met dezelfde bestandsnaam zijn. Als je een afbeelding overschrijft of alle afbeeldingen wist, dan kan dat niet ongedaan worden gemaakt. "),n("br"),n("br")],-1)),n("div",Ee,[e[13]||(e[13]=n("em",{class:"label"},"Status",-1)),n("div",xe,[n("p",null,[n("span",{id:"upload-status-light",class:A(s(o).status)},null,2),n("strong",null,x(s(D)[s(o).status].short||s(o).status),1)]),n("p",null,x(s(D)[s(o).status].long),1)]),e[14]||(e[14]=n("em",{class:"label"},"Configuratie",-1)),n("div",Ue,[n("p",null,[e[8]||(e[8]=m("Serveradres")),n("span",Ve,x(s(u).url),1)]),d(f,{modelValue:s(u).username,"onUpdate:modelValue":e[1]||(e[1]=r=>s(u).username=r),identifier:"username"},{default:l(()=>e[9]||(e[9]=[n("span",null,"Gebruikersnaam",-1)])),_:1,__:[9]},8,["modelValue"]),d(f,{modelValue:s(u).password,"onUpdate:modelValue":e[2]||(e[2]=r=>s(u).password=r),identifier:"password"},{default:l(()=>e[10]||(e[10]=[n("span",null,"Wachtwoord",-1)])),_:1,__:[10]},8,["modelValue"])]),d(p,{class:"primary full",onClick:e[3]||(e[3]=r=>{k.value=!1,s(o).connect()})},{default:l(()=>[d(_,null,{default:l(()=>e[11]||(e[11]=[m("check")])),_:1,__:[11]}),e[12]||(e[12]=m("Vernieuwen "))]),_:1,__:[12]})])]),_:1,__:[15,16]})):F("",!0)]),_:1})])}}}),De=G(je,[["__scopeId","data-v-defa657e"]]),Ae={id:"pictures"},Ne={class:"grid"},Fe=["src"],Ie={key:0,class:"message"},Me={key:1,class:"message"},Le={class:"control dotnav"},ze=["onClick"],Be={key:0},Pe={key:1},Oe={key:0,class:"dropzone"},Re=P({__name:"SlideshowView",setup(h){const c=$(null),v=$(null),o=H(),u=$(0),k=se("slideshow-duration",60),{isFullscreen:T,enter:e,exit:_}=te(c),p=oe("history"),a=$(p.fullscreen==="true");function f(){T.value||a.value?(a.value=!1,_()):e()}const w=$(!1);let r,b;function S(){w.value=!0,clearTimeout(r),r=setTimeout(()=>{w.value=!1},2e3)}S();function U(){u.value=(u.value+1)%o.images.length||0}function L(){u.value=(u.value-1+o.images.length)%o.images.length||0}function V(){clearTimeout(b),b=setTimeout(()=>{U(),V()},k.value*1e3)}V();function z(C){if(!(document.activeElement&&(document.activeElement.tagName==="INPUT"||document.activeElement.tagName==="TEXTAREA")))switch(C.key){case"ArrowLeft":L();break;case"ArrowRight":U();break;case"Escape":case"F11":case"F5":case"f":C.preventDefault(),f();break;default:if(!isNaN(Number(C.key))){const t=Number(C.key)-1;t>=0&&t<o.images.length&&(u.value=t)}break}}window.addEventListener("keydown",z),pe(()=>{window.removeEventListener("keydown",z)});const{isOverDropZone:Z}=ae(v,{onDrop:o.filesUploaded,dataTypes:["image/png","image/jpeg","image/webp","image/gif","image/*"],multiple:!0});return(C,t)=>{var B;const q=_e,J=De,E=O,W=ue,X=R,Q=ie,Y=re,ee=le;return i(),g("main",{ref_key:"main",ref:v},[d(q),d(J,{onSlideClicked:t[0]||(t[0]=y=>u.value=y)}),n("section",Ae,[n("div",Ne,[n("div",null,[t[9]||(t[9]=n("h2",null,"Diavoorstelling",-1)),n("div",{class:A(["carousel",{"mouse-moving":w.value,"fake-fullscreen":a.value}]),ref_key:"carousel",ref:c,onMousemove:S,onMouseenter:t[1]||(t[1]=y=>w.value=!0),onMouseleave:t[2]||(t[2]=y=>w.value=!1)},[d(fe,{name:"slide"},{default:l(()=>[(i(!0),g(I,null,M(s(o).images,(y,j)=>ve((i(),g("img",{key:y,src:y},null,8,Fe)),[[we,j===u.value]])),128))]),_:1}),["sending","receiving"].includes(s(o).status)?(i(),g("p",Ie,"Laden...")):(B=s(o).images)!=null&&B.length?F("",!0):(i(),g("p",Me,"Leeg")),n("button",{class:"control fullscreen",onClick:f},[s(T)||a.value?(i(),N(E,{key:0},{default:l(()=>t[5]||(t[5]=[m("fullscreen_exit")])),_:1,__:[5]})):(i(),N(E,{key:1},{default:l(()=>t[6]||(t[6]=[m("fullscreen")])),_:1,__:[6]}))]),n("button",{class:"control previous",onClick:L},[d(E,null,{default:l(()=>t[7]||(t[7]=[m("chevron_left")])),_:1,__:[7]})]),n("button",{class:"control next",onClick:U},[d(E,null,{default:l(()=>t[8]||(t[8]=[m("chevron_right")])),_:1,__:[8]})]),n("div",Le,[(i(!0),g(I,null,M(s(o).images,(y,j)=>(i(),g("button",{onClick:Ge=>u.value=j,class:A({active:j===u.value})},null,10,ze))),256))])],34)]),d(ee,null,{default:l(()=>[d(Y,null,{default:l(()=>[d(Q,{value:"Opties"},{default:l(()=>[n("fieldset",null,[t[13]||(t[13]=n("legend",null,"Automatische weergave",-1)),d(W,{modelValue:s(k),"onUpdate:modelValue":t[3]||(t[3]=y=>ge(k)?k.value=y:null),modelModifiers:{number:!0},onChange:V,identifier:"slideDuration",step:"1",min:"1",max:"240",unit:"s"},{default:l(()=>[t[10]||(t[10]=m(" Seconden per dia ")),s(k)>0?(i(),g("small",Be," Elke "+x(s(k))+" seconden wordt de volgende dia getoond. ",1)):(i(),g("small",Pe," De automatische weergave is uitgeschakeld. "))]),_:1,__:[10]},8,["modelValue"]),d(X,{class:"secondary full",onClick:t[4]||(t[4]=y=>{u.value=0,V(),f()})},{default:l(()=>[d(E,null,{default:l(()=>t[11]||(t[11]=[m("play_arrow")])),_:1,__:[11]}),t[12]||(t[12]=m("Automatische weergave starten "))]),_:1,__:[12]})])]),_:1})]),_:1})]),_:1})])]),s(Z)?(i(),g("div",Oe," Laat los om bestand(en) te uploaden ")):F("",!0)],512)}}}),Je=G(Re,[["__scopeId","data-v-24e85bc5"]]);export{Je as default};
