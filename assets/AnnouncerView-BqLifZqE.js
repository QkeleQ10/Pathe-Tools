var Te=Object.defineProperty;var Ve=(s,r,p)=>r in s?Te(s,r,{enumerable:!0,configurable:!0,writable:!0,value:p}):s[r]=p;var H=(s,r,p)=>Ve(s,typeof r!="symbol"?r+"":r,p);import{_ as le,a as fe}from"./server-93_2qsv4.js";import{b as pe,_ as be,a as Se}from"./InputNumber-VkYIzCnx.js";import{d as X,A as J,B as W,c as f,F as I,q as E,h as N,g as c,w as m,a as ee,b as u,C as ie,l as y,D as Oe,T as oe,k as R,y as ne,o as n,j as k,u as V,_ as Q,m as te,E as ke,r as F,s as G,G as de,H as $e,I as xe,i as Ne,J as Ue,K as Ce,p as Z,f as K,v as me}from"./index-CtDS5ven.js";import{a as ge,u as Me,_ as De}from"./TimetableUploadSection-DTDsGL6n.js";import{u as Y,a as Ae,_ as Be}from"./FileUploadBlock-DnecZAH7.js";import{_ as Ie}from"./Chip-e2wQKBG8.js";import"./nl-DjY-uKhQ.js";const Ee="/Pathe-Tools/assets/rosetta-Cn53EfYD.ogg",Re="/Pathe-Tools/assets/gerwim-CqHIXSuO.ogg",je="/Pathe-Tools/assets/jaron-CS_9Sx9l.ogg",Le="/Pathe-Tools/assets/danique-C_bjxFfD.ogg",Pe="/Pathe-Tools/assets/quinten-DogOe9-k.ogg";class q{constructor(r){H(this,"name");H(this,"language");H(this,"file");H(this,"sprite");this.name=r.name,this.language=r.language,this.file=r.file,this.sprite=r.sprite}get sounds(){return Object.keys(this.sprite)}get additionalSounds(){return this.sounds.filter(r=>!M.default.sounds.includes(r))}}const M={default:new q({name:"Rosetta",language:"nl",file:Ee,sprite:{auditorium01:[0,937.0294784580499],auditorium02:[1200,982.9931972789117],auditorium03:[2400,863.6281179138323],auditorium04:[3600,1022.8571428571427],auditorium05:[5800,1023.1065759637188],auditorium06:[8e3,1016.2585034013603],auditorium07:[10200,1187.2335600907036],auditorium08:[12400,1109.2290249433106],auditorium09:[14600,1185.2154195011337],auditorium10:[16800,959.9773242630398],auditorium11:[18000.000000000004,1122.6077097505681],auditorium12:[20200.000000000004,1185.8049886621309],auditorium13:[22400.000000000004,1159.6825396825388],auditorium14:[24600,1169.5918367346926],auditorium15:[26800,1240.1360544217682],auditorium16:[29e3,1161.0884353741503],auditorium17:[31200,1213.2426303854907],auditorium18:[33400.00000000001,1123.990929705215],auditorium19:[35600.00000000001,1342.7664399092976],auditorium20:[37800.000000000015,1263.8321995464848],chime:[40000.000000000015,3084.51247165533],credits:[44200.000000000015,924.7165532879791],end:[45400.000000000015,1289.478458049885],mainshow:[47600.00000000001,1445.963718820863],preshow:[49800.000000000015,1364.3990929705226],start:[52000.000000000015,686.9841269841288]}}),gerwim:new q({name:"Gerwim",language:"nl",file:Re,sprite:{auditorium01:[0,824.9659863945578],auditorium02:[1200,870.907029478458],auditorium03:[2400,790.2040816326532],auditorium04:[3600,886.825396825397],auditorium05:[4800,838.526077097506],auditorium06:[6e3,866.7573696145121],auditorium07:[7199.999999999999,987.7777777777776],auditorium10:[8399.999999999998,665.6689342403635],credits:[9600,936.5532879818588],start:[10799.999999999998,638.9342403628114]}}),jaron:new q({name:"Jaron",language:"nl",file:je,sprite:{auditorium01:[0,996.2585034013606],auditorium02:[1200,977.2562358276645],auditorium03:[2400,1053.9229024943313],auditorium04:[4600,1109.8866213151925],auditorium05:[6799.999999999999,1125.5328798185947],auditorium06:[9e3,1083.7641723356005],auditorium07:[11200,1070.2947845804988],auditorium08:[13399.999999999998,1134.9206349206345],auditorium09:[15599.999999999998,1259.2517006802736],auditorium10:[17800,750.5895691609971],credits:[19e3,920.6575963718819],end:[20200,1177.0748299319714],finalshow:[22400,1377.0068027210875],mainshow:[24599.999999999996,1302.0634920634925],start:[26799.999999999996,737.8458049886625]}}),danique:new q({name:"Danique",language:"nl",file:Le,sprite:{auditorium01:[0,737.9591836734694],auditorium02:[1200,820.340136054422],auditorium03:[2400.0000000000005,677.482993197279],auditorium04:[3600.0000000000005,822.6530612244902],auditorium05:[4800.000000000001,810.5442176870747],auditorium06:[6000.000000000001,795.4875283446717],auditorium07:[7200.000000000001,926.8027210884355],auditorium08:[8400,871.0430839002274],auditorium09:[9600.000000000002,941.8820861677997],auditorium10:[10800,689.569160997733],credits:[12000.000000000002,786.3718820861685],end:[13200.000000000004,1149.2743764172335],start:[15400.000000000002,520.2040816326523]}}),quinten:new q({name:"Quinten",language:"nl",file:Pe,sprite:{auditorium01:[0,743.7414965986394],auditorium02:[1200,756.5759637188207],auditorium03:[2400,732.0861678004537],auditorium04:[3600,725.6235827664397],auditorium05:[4800,846.485260770975],auditorium06:[6e3,790.9297052154196],auditorium07:[7200,939.3877551020404],auditorium08:[8400,841.7006802721083],auditorium09:[9600,1026.190476190477],auditorium10:[11800,711.0204081632645],auditorium11:[13e3,863.2653061224485],auditorium12:[14200,1008.8208616780037],auditorium13:[16400,869.6371882086175],auditorium14:[17599.999999999996,961.0430839002255],auditorium15:[18799.999999999996,1017.5283446712023],auditorium16:[20999.999999999996,1057.664399092971],auditorium17:[23199.999999999996,1032.1315192743762],auditorium18:[25399.999999999996,958.7074829931978],auditorium19:[26599.999999999993,1050.8616780045336],auditorium20:[28799.999999999993,1045.6462585033996],credits:[30999.999999999993,690.6122448979595],end:[32199.999999999996,1004.1723356009059],intermission:[34399.99999999999,568.7301587301619],mainshow:[35599.99999999999,1155.2607709750546],preshow:[37799.99999999999,1171.224489795918],start:[39999.99999999999,547.0068027210857]}})};function z(s){const r={start:"start",mainshow:"start hoofdfilm",intermission:"pauze",credits:"aftiteling",end:"einde voorstelling",preshow:"start voorprogramma",finalshow:"laatste voorstelling",chime:"♪"};s=s.toLowerCase().trim();let p=s.replace(/\?+/g,""),_=r[p]||p,w=Object.values(M).some(e=>e.sounds.includes(p)),b=1/Math.pow(2,(s.match(/\?+/g)||[""])[0].length);s.includes("|")&&(_=s.split("|").map(e=>z(e).name).join("|"),w=_.split("|").every(e=>e!==p),b=1);let $=p.match(/^(auditorium)([0-9]+|(#))$/);return $&&(_=`zaal ${$[2]=="#"?"#":Number($[2])}`,w=!0),{id:p,name:_,valid:w,probability:b}}const ze={key:0,class:"segment-list"},He=["value"],qe={key:1},Fe={class:"flex",style:{"margin-top":"16px"}},Ge=X({__name:"AnnouncementBuilder",props:J({noButton:{type:Boolean,default:!1},playButton:{type:Boolean,default:!1}},{modelValue:{},modelModifiers:{},show:{type:Boolean,default:!1},showModifiers:{}}),emits:J(["play"],["update:modelValue","update:show"]),setup(s,{emit:r}){const p=W(s,"modelValue"),_=W(s,"show"),w=r,b=[...new Set(Object.values(M).flatMap(l=>l.sounds))];function $(){p.value.push({spriteName:"",offset:0})}function e(l){return l.charAt(0).toUpperCase()+l.slice(1)}return(l,o)=>{const S=ie,T=ne,x=fe,A=pe,j=le;return n(),f(I,null,[s.noButton?N("",!0):(n(),E(T,Oe({key:0,class:"secondary announcement-builder-button",onClick:o[0]||(o[0]=B=>_.value=!0)},l.$attrs),{default:m(()=>[ee(l.$slots,"default",{},()=>[c(S,null,{default:m(()=>o[3]||(o[3]=[y("build")])),_:1,__:[3]}),o[4]||(o[4]=u("span",null,"Omroep bewerken",-1))],!0)]),_:3},16)),c(oe,null,{default:m(()=>[_.value?(n(),E(j,{key:0,onDismiss:o[2]||(o[2]=B=>_.value=!1)},{default:m(()=>[o[10]||(o[10]=u("h3",null,"Omroeponderdelen",-1)),p.value.length?(n(),f("ul",ze,[(n(!0),f(I,null,R(p.value,(B,i)=>(n(),f("li",{class:"segment",key:i},[c(x,{class:"no-label",identifier:"spriteName"+i,modelValue:B.spriteName,"onUpdate:modelValue":D=>B.spriteName=D,spellcheck:!1,autocomplete:"off",autocapitalize:"off"},{datalist:m(()=>[(n(),f(I,null,R(b,D=>u("option",{key:D,value:D},k(e(V(z)(D).name)),9,He)),64))]),_:2},1032,["identifier","modelValue","onUpdate:modelValue"]),c(A,{class:"no-label",identifier:"offset"+i,modelValue:B.offset,"onUpdate:modelValue":D=>B.offset=D,unit:"ms"},null,8,["identifier","modelValue","onUpdate:modelValue"]),c(S,{style:{float:"right",cursor:"pointer",padding:"2px"},onClick:D=>p.value.splice(i,1)},{default:m(()=>o[5]||(o[5]=[y(" delete")])),_:2,__:[5]},1032,["onClick"])]))),128))])):(n(),f("p",qe," Geen onderdelen gevonden. ")),u("div",Fe,[c(T,{class:"secondary add-rule",onClick:$},{default:m(()=>[c(S,null,{default:m(()=>o[6]||(o[6]=[y("add")])),_:1,__:[6]}),o[7]||(o[7]=y(" Nieuw onderdeel "))]),_:1,__:[7]}),s.playButton?(n(),E(T,{key:0,class:"secondary add-rule",onClick:o[1]||(o[1]=B=>w("play"))},{default:m(()=>[c(S,null,{default:m(()=>o[8]||(o[8]=[y("play_arrow")])),_:1,__:[8]}),o[9]||(o[9]=y(" Afspelen "))]),_:1,__:[9]})):N("",!0)])]),_:1,__:[10]})):N("",!0)]),_:1})],64)}}}),ce=Q(Ge,[["__scopeId","data-v-b8b48b82"]]),We=["for"],Xe={class:"title"},Je=["id"],Qe=X({__name:"InputSelect",props:J({identifier:{}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(s){const r=W(s,"modelValue");return(p,_)=>(n(),f("label",{class:"input select-input",for:p.identifier},[u("div",Xe,[ee(p.$slots,"default",{},void 0,!0)]),te(u("select",{id:p.identifier,"onUpdate:modelValue":_[0]||(_[0]=w=>r.value=w)},[ee(p.$slots,"options",{},void 0,!0)],8,Je),[[ke,r.value]])],8,We))}}),Ze=Q(Qe,[["__scopeId","data-v-15be24ca"]]),Ke={key:1,class:"input timing-input"},Ye=["value"],et={key:2},tt={style:{opacity:".5"}},lt={key:0},it={key:1},ot={key:2},nt={style:{opacity:".5"}},st={key:0,style:{opacity:".5"}},at={key:0},ut={key:1},rt={key:2},dt={key:3},mt={key:4},ft={key:1,style:{opacity:".5"}},pt={key:1},gt=X({__name:"RuleList",props:J({toggleOnly:{type:Boolean,default:!1}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(s){const r=F(!1),p=F(!1),_=W(s,"modelValue"),w={scheduledTime:"inloop",showTime:"start",mainShowTime:"start hoofdfilm",intermissionTime:"pauze",creditsTime:"aftiteling",endTime:"einde voorstelling"};function b(){const $={id:Date.now().toString(),enabled:!0,segments:[{spriteName:"chime",offset:-800},{spriteName:"auditorium#",offset:0}],trigger:{property:"scheduledTime",preponeMinutes:0},filter:{plfOnly:!1,lastShowOnly:!1,firstShowOnly:!1,playlistTitleIncludes:"",playlistTitleExcludes:""}};_.value.push($)}return($,e)=>{const l=ie,o=ge,S=pe,T=Ze,x=ce,A=fe,j=le,B=ne;return n(),f(I,null,[_.value.length?(n(),f("ul",{key:0,class:G(["rule-list",{"toggle-only":s.toggleOnly}])},[(n(!0),f(I,null,R(_.value,(i,D)=>(n(),f("li",{class:G(["rule",{active:i.enabled}]),key:i.id},[s.toggleOnly?N("",!0):(n(),E(l,{key:0,style:{float:"right",cursor:"pointer",padding:"2px"},onClick:g=>_.value.splice(D,1)},{default:m(()=>e[4]||(e[4]=[y(" delete")])),_:2,__:[4]},1032,["onClick"])),c(o,{class:"toggler",identifier:i.id+"enabled",modelValue:i.enabled,"onUpdate:modelValue":g=>i.enabled=g},{default:m(()=>[y(k(i.name||"Eigen regel"),1)]),_:2},1032,["identifier","modelValue","onUpdate:modelValue"]),s.toggleOnly?(n(),f("p",et,[e[10]||(e[10]=y(" Timing: ")),u("span",tt,[i.trigger.preponeMinutes>0?(n(),f("span",lt,[u("b",null,k(i.trigger.preponeMinutes)+" min.",1),e[7]||(e[7]=y(" vóór"))])):i.trigger.preponeMinutes<0?(n(),f("span",it,[u("b",null,k(-i.trigger.preponeMinutes)+" min.",1),e[8]||(e[8]=y(" na"))])):(n(),f("span",ot,"bij")),e[9]||(e[9]=y()),u("b",null,k(w[i.trigger.property]),1)])])):(n(),f("div",Ke,[e[6]||(e[6]=u("span",null,"Timing:",-1)),u("span",null,[c(S,{class:"no-label",identifier:i.id+"triggerPreponeMinutes",unit:"min.",modelValue:i.trigger.preponeMinutes,"onUpdate:modelValue":g=>i.trigger.preponeMinutes=g},null,8,["identifier","modelValue","onUpdate:modelValue"]),e[5]||(e[5]=y(" vóór ")),c(T,{class:"no-label",identifier:i.id+"triggerProperty",modelValue:i.trigger.property,"onUpdate:modelValue":g=>i.trigger.property=g},{options:m(()=>[(n(),f(I,null,R(w,(g,L)=>u("option",{key:L,value:L},k(g),9,Ye)),64))]),_:2},1032,["identifier","modelValue","onUpdate:modelValue"])])])),u("a",{onClick:e[0]||(e[0]=()=>{s.toggleOnly||(r.value=!0)})},[e[11]||(e[11]=u("u",null,"Omroep",-1)),e[12]||(e[12]=y(": ")),u("span",nt,k(i.segments.map(g=>V(z)(g.spriteName).name).join(" - ")),1)]),c(x,{"no-button":"",modelValue:i.segments,"onUpdate:modelValue":g=>i.segments=g,show:r.value,"onUpdate:show":e[1]||(e[1]=g=>r.value=g)},{default:m(()=>[c(l,null,{default:m(()=>e[13]||(e[13]=[y("build")])),_:1,__:[13]}),u("span",null,k(i.segments.map(g=>V(z)(g.spriteName).name).join(" - ")),1)]),_:2},1032,["modelValue","onUpdate:modelValue","show"]),e[27]||(e[27]=u("br",null,null,-1)),!s.toggleOnly||Object.values(i.filter).some(g=>typeof g=="string"?g.length>0:g)?(n(),f("a",{key:3,onClick:e[2]||(e[2]=()=>{s.toggleOnly||(p.value=!0)})},[e[19]||(e[19]=u("u",null,"Filter",-1)),e[20]||(e[20]=y(": ")),Object.values(i.filter).some(g=>typeof g=="string"?g.length>0:g)?(n(),f("span",st,[e[18]||(e[18]=y(" alleen ")),i.filter.lastShowOnly?(n(),f("b",at,"de laatste ")):N("",!0),i.filter.firstShowOnly?(n(),f("b",ut,"de eerste ")):N("",!0),i.filter.plfOnly?(n(),f("b",rt,"4DX-")):N("",!0),y("voorstelling"+k(i.filter.lastShowOnly||i.filter.firstShowOnly?"":"en")+" ",1),i.filter.playlistTitleIncludes?(n(),f("span",dt,[e[14]||(e[14]=y("met ")),u("b",null,k(i.filter.playlistTitleIncludes),1),e[15]||(e[15]=y(" in de titel "))])):N("",!0),i.filter.playlistTitleExcludes?(n(),f("span",mt,[e[16]||(e[16]=y("zonder ")),u("b",null,k(i.filter.playlistTitleExcludes),1),e[17]||(e[17]=y(" in de titel "))])):N("",!0)])):(n(),f("span",ft,"elke voorstelling"))])):N("",!0),c(oe,null,{default:m(()=>[p.value?(n(),E(j,{key:0,onDismiss:e[3]||(e[3]=g=>p.value=!1),class:"filters"},{default:m(()=>[e[26]||(e[26]=u("h3",null,"Filter",-1)),c(o,{identifier:i.id+"plfOnly",modelValue:i.filter.plfOnly,"onUpdate:modelValue":g=>i.filter.plfOnly=g},{default:m(()=>e[21]||(e[21]=[y(" Alleen 4DX-voorstellingen ")])),_:2,__:[21]},1032,["identifier","modelValue","onUpdate:modelValue"]),c(o,{identifier:i.id+"lastShowOnly",modelValue:i.filter.lastShowOnly,"onUpdate:modelValue":g=>i.filter.lastShowOnly=g},{default:m(()=>e[22]||(e[22]=[y(" Alleen de laatste overeenkomst ")])),_:2,__:[22]},1032,["identifier","modelValue","onUpdate:modelValue"]),c(o,{identifier:i.id+"firstShowOnly",modelValue:i.filter.firstShowOnly,"onUpdate:modelValue":g=>i.filter.firstShowOnly=g},{default:m(()=>e[23]||(e[23]=[y(" Alleen de eerste overeenkomst ")])),_:2,__:[23]},1032,["identifier","modelValue","onUpdate:modelValue"]),c(A,{identifier:i.id+"playlistTitleIncludes",modelValue:i.filter.playlistTitleIncludes,"onUpdate:modelValue":g=>i.filter.playlistTitleIncludes=g},{default:m(()=>e[24]||(e[24]=[y(" Titel moet bevatten ")])),_:2,__:[24]},1032,["identifier","modelValue","onUpdate:modelValue"]),c(A,{identifier:i.id+"playlistTitleExcludes",modelValue:i.filter.playlistTitleExcludes,"onUpdate:modelValue":g=>i.filter.playlistTitleExcludes=g},{default:m(()=>e[25]||(e[25]=[y(" Titel mag niet bevatten ")])),_:2,__:[25]},1032,["identifier","modelValue","onUpdate:modelValue"])]),_:2,__:[26]},1024)):N("",!0)]),_:2},1024)],2))),128))],2)):(n(),f("p",pt," Geen regels gevonden. ")),s.toggleOnly?N("",!0):(n(),E(B,{key:2,class:"secondary add-rule",onClick:b},{default:m(()=>[c(l,null,{default:m(()=>e[28]||(e[28]=[y("add")])),_:1,__:[28]}),e[29]||(e[29]=y(" Nieuwe regel "))]),_:1,__:[29]}))],64)}}}),ct=Q(gt,[["__scopeId","data-v-5d7ffa21"]]),yt=X({__name:"VoicesSelector",props:{modelValue:{default:["default"]},modelModifiers:{}},emits:["update:modelValue"],setup(s){const r=W(s,"modelValue");function p(_,w){if(_)r.value.push(w);else{const b=r.value.indexOf(w);b>-1&&r.value.splice(b,1)}}return(_,w)=>{const b=ge;return n(!0),f(I,null,R(V(M),($,e)=>(n(),E(b,{key:e,modelValue:r.value.includes(e),"onUpdate:modelValue":l=>p(l,e),identifier:e},{default:m(()=>[y(k($.name),1)]),_:2},1032,["modelValue","onUpdate:modelValue","identifier"]))),128)}}});function _t(s){const r=s.numberOfChannels,p=s.sampleRate,_=16,w=r*(_/8),b=p*w,$=new ArrayBuffer(44+s.length*w),e=new DataView($);let l=0;function o(S){for(let T=0;T<S.length;T++)e.setUint8(l++,S.charCodeAt(T))}o("RIFF"),e.setUint32(l,36+s.length*w,!0),l+=4,o("WAVE"),o("fmt "),e.setUint32(l,16,!0),l+=4,e.setUint16(l,1,!0),l+=2,e.setUint16(l,r,!0),l+=2,e.setUint32(l,p,!0),l+=4,e.setUint32(l,b,!0),l+=4,e.setUint16(l,w,!0),l+=2,e.setUint16(l,_,!0),l+=2,o("data"),e.setUint32(l,s.length*w,!0),l+=4;for(let S=0;S<s.length;S++)for(let T=0;T<r;T++){const x=Math.max(-1,Math.min(1,s.getChannelData(T)[S]));e.setInt16(l,x<0?x*32768:x*32767,!0),l+=2}return new Blob([e],{type:"audio/wav"})}async function vt(s){const r=new AudioContext,p=new Map;for(const{voice:l}of s)if(!p.has(l)){const S=await(await fetch(l.file)).arrayBuffer(),T=await r.decodeAudioData(S);p.set(l,T)}let _=0,w=0;for(let l=0;l<s.length;l++){const o=s[l],[S,T]=o.voice.sprite[o.spriteName]||[0,0],x=_+T/1e3;x>w&&(w=x),_+=(T+(o.offset||0))/1e3}const b=new OfflineAudioContext(2,Math.ceil(w*44100),44100);_=0;for(let l=0;l<s.length;l++){const o=s[l],[S,T]=o.voice.sprite[o.spriteName]||[0,0],x=p.get(o.voice);if(!x)return;const A=b.createBufferSource();A.buffer=x;const j=Math.max(0,_);A.start(j,S/1e3,T/1e3),A.connect(b.destination),_+=(T+(o.offset||0))/1e3}const $=await b.startRendering(),e=_t($);return URL.createObjectURL(e)}const wt={class:"flex",style:{"flex-wrap":"wrap-reverse"}},ht={style:{flex:"50% 1 1"}},Tt={id:"upcoming-announcements"},Vt={class:"room"},bt={class:"title"},St={class:"time"},Ot={class:"flex chips"},kt=["onDblclick"],$t={key:"0"},xt={key:1},Nt={style:{position:"relative"}},Ut={class:"manual-sounds-list"},Ct=["onClick"],Mt={key:1},Dt={key:0},At={key:0,class:"dropzone"},Bt=X({__name:"AnnouncerView",setup(s){const r=Me(),p=Ue("now"),_=de("main"),w=de("audios"),b=F(!1),$=[{id:"plfStart",name:"4DX-inloop",segments:[{spriteName:"chime",offset:-800},{spriteName:"start",offset:0},{spriteName:"auditorium#",offset:0}],enabled:!0,trigger:{property:"scheduledTime",preponeMinutes:15},filter:{plfOnly:!0,lastShowOnly:!1,firstShowOnly:!1,playlistTitleIncludes:"",playlistTitleExcludes:""}},{id:"start",name:"Start",segments:[{spriteName:"chime",offset:-800},{spriteName:"start",offset:0},{spriteName:"auditorium#",offset:0}],enabled:!1,trigger:{property:"scheduledTime",preponeMinutes:0},filter:{plfOnly:!1,lastShowOnly:!1,firstShowOnly:!1,playlistTitleIncludes:"",playlistTitleExcludes:""}},{id:"mainShow",name:"Start hoofdfilm",segments:[{spriteName:"chime",offset:-800},{spriteName:"mainshow",offset:0},{spriteName:"auditorium#",offset:0}],enabled:!1,trigger:{property:"mainShowTime",preponeMinutes:0},filter:{plfOnly:!1,lastShowOnly:!1,firstShowOnly:!1,playlistTitleIncludes:"",playlistTitleExcludes:""}},{id:"intermission",name:"Pauze",segments:[{spriteName:"chime",offset:-800},{spriteName:"intermission",offset:0},{spriteName:"auditorium#",offset:0}],enabled:!0,trigger:{property:"intermissionTime",preponeMinutes:1},filter:{plfOnly:!1,lastShowOnly:!1,firstShowOnly:!1,playlistTitleIncludes:"",playlistTitleExcludes:""}},{id:"credits",name:"Aftiteling",segments:[{spriteName:"chime",offset:-800},{spriteName:"credits",offset:0},{spriteName:"auditorium#",offset:0}],enabled:!0,trigger:{property:"creditsTime",preponeMinutes:1},filter:{plfOnly:!1,lastShowOnly:!1,firstShowOnly:!1,playlistTitleIncludes:"",playlistTitleExcludes:""}},{id:"end",name:"Einde voorstelling",segments:[{spriteName:"chime",offset:-800},{spriteName:"end",offset:0},{spriteName:"auditorium#",offset:0}],enabled:!1,trigger:{property:"endTime",preponeMinutes:0},filter:{plfOnly:!1,lastShowOnly:!1,firstShowOnly:!1,playlistTitleIncludes:"",playlistTitleExcludes:""}},{id:"finalMainShowStart",name:"Start laatste hoofdfilm",segments:[{spriteName:"chime",offset:-800},{spriteName:"finalshow",offset:0}],enabled:!1,trigger:{property:"mainShowTime",preponeMinutes:0},filter:{plfOnly:!1,lastShowOnly:!0,firstShowOnly:!1,playlistTitleIncludes:"",playlistTitleExcludes:""}}],e=Y("default-rules",$,localStorage,{mergeDefaults:!0});for(let d=0;d<$.length;d++){const t=$[d];e.value.findIndex(h=>h.id===t.id)===-1&&e.value.splice(d,0,t)}const l=Y("custom-rules",[],localStorage,{mergeDefaults:!0}),o=Y("preferred-voices",["default"],localStorage,{mergeDefaults:!0}),S=F([{spriteName:"chime",offset:-800}]),T=F([]);r.$subscribe(A,{deep:!0});let x=null;$e(()=>{A(),x=setInterval(j,1e4)}),xe(()=>{x&&clearInterval(x)});function A(){w.value.innerHTML="";let d=[];for(const t of[...e.value,...l.value]){if(!t.enabled)continue;let v=[];r.table.forEach((h,U)=>{if(B(h,U,t)){const O={time:new Date(h[t.trigger.property].getTime()-(t.trigger.preponeMinutes||0)*6e4-5e3),show:h,segments:t.segments.map(P=>({...P,spriteName:P.spriteName.replace("#",`${String(h.auditoriumNumber).padStart(2,"0")}`)})),audio:null};O.time.getTime()>Date.now()&&v.push(O)}}),v.sort((h,U)=>h.time.getTime()-U.time.getTime()),t.filter.firstShowOnly&&(v=v.slice(0,1)),t.filter.lastShowOnly&&(v=v.slice(-1)),d.push(...v)}T.value=d.sort((t,v)=>t.time.getTime()-v.time.getTime()),j()}async function j(){for(const d of T.value){const t=d.time.getTime()-Date.now()-1e3;if(t>-1e3&&t<1e4&&!d.audio){const v=D(d.segments,o.value.map(h=>M[h]));d.audio=await g(v),w.value.appendChild(d.audio),setTimeout(()=>{var U;const h=Array.from(w.value.children).find(O=>O!==d.audio&&!O.paused);h?h.addEventListener("ended",()=>{var O;(O=d.audio)==null||O.play()},{once:!0}):(U=d.audio)==null||U.play()},Math.max(0,t))}}}function B(d,t,v){let h=!0;return!d[v.trigger.property]||!d[v.trigger.property].getTime()?!1:(v.filter.plfOnly&&!d.auditorium.includes("4DX")&&(h=!1),v.filter.playlistTitleIncludes&&!d.title.toLowerCase().includes(v.filter.playlistTitleIncludes.toLowerCase())&&(h=!1),v.filter.playlistTitleExcludes&&d.title.toLowerCase().includes(v.filter.playlistTitleExcludes.toLowerCase())&&(h=!1),h)}function i(d){return d<6e4?Math.floor(d/1e3)+" s":d<6e5?Math.floor(d/6e4)+":"+String(Math.floor(d%6e4/1e3)).padStart(2,"0")+" min":d<36e5?Math.floor(d/6e4)+" min":Math.floor(d/36e5)+":"+String(Math.floor(d%36e5/6e4)).padStart(2,"0")+" h"}function D(d,t){const v=t.sort(()=>.5-Math.random()),h=Object.values(M);for(const U of v)if(d.every(O=>O.spriteName==="chime"||U.sprite[O.spriteName]))return d.map(O=>({...O,voice:O.spriteName==="chime"?M.default:U}));return d.map(U=>{const O=[...v,...h].find(P=>P.sprite[U.spriteName]);return{...U,voice:(U.spriteName==="chime"?M.default:O)||M.default}})}function g(d){return new Promise(async t=>{const v=await vt(d),h=new Audio(v);h.addEventListener("ended",()=>{h.remove()}),t(h)})}async function L(d,t=o.value.map(v=>M[v])){const v=D(d,t);(await g(v)).play()}const{isOverDropZone:ye}=Ae(_,{onDrop:r.filesUploaded,multiple:!1});return(d,t)=>{const v=Ne,h=De,U=Ie,O=ie,P=yt,_e=ce,se=ne,ve=Be,ae=ct,ue=Se,we=be,he=le;return n(),f("main",{ref_key:"main",ref:_},[c(v),c(h),u("section",null,[u("div",wt,[u("div",ht,[t[9]||(t[9]=u("h2",null,"Geplande omroepen",-1)),u("div",Tt,[c(Ce,{name:"list"},{default:m(()=>[(n(!0),f(I,null,R(T.value,a=>te((n(),f("div",{class:G(["film",{announcing:a.audio&&!a.audio.paused}]),key:a.time.getTime()},[u("div",Vt,k(a.show.auditorium==="PULR 8"||a.show.auditorium==="Rooftop"?"RT":a.show.auditorium.replace(/^\w+\s/,"")),1),u("div",bt,k(a.show.title),1),u("div",St,k(V(K)(a.show.scheduledTime,"HH:mm"))+" – "+k(V(K)(a.show.endTime,"HH:mm:ss")),1),u("div",Ot,[(n(!0),f(I,null,R(a.show.extras,C=>(n(),E(U,{class:G({"translucent-white":C.match(/\(.+\)/)})},{default:m(()=>[y(k(C.replace(/\((.+)\)/,"$1")),1)]),_:2},1032,["class"]))),256))]),u("div",{class:"announcement",onDblclick:C=>L(a.segments),style:{display:"grid","grid-template-columns":"64px 130px 1fr"}},[c(O,null,{default:m(()=>t[8]||(t[8]=[y("schedule")])),_:1,__:[8]}),u("div",null,k(V(K)(a.time,"HH:mm:ss"))+" ("+k(i(a.time.getTime()-V(p).getTime()))+") ",1),u("div",null," '"+k(a.segments.map(C=>V(z)(C.spriteName).name).join(" "))+"' ",1)],40,kt)],2)),[[me,a.time.getTime()-V(p).getTime()>-5e3||a.audio&&!a.audio.paused]])),128)),T.value.filter(a=>V(p).getTime()-a.time.getTime()<1e4).length<1?(n(),f("p",$t,"Er zijn geen omroepen gepland.")):N("",!0),V(r).table.length<1?(n(),f("p",xt,"Upload eerst een bestand.")):N("",!0)]),_:1})])]),c(ve,{style:{flex:"30% 1 1"}},{default:m(()=>[t[18]||(t[18]=u("h2",null,"Opties",-1)),u("fieldset",null,[t[10]||(t[10]=u("legend",null,"Stemmen",-1)),c(P,{modelValue:V(o),"onUpdate:modelValue":t[0]||(t[0]=a=>Z(o)?o.value=a:null)},null,8,["modelValue"])]),u("fieldset",Nt,[t[14]||(t[14]=u("legend",null,"Handmatige omroep",-1)),c(_e,{modelValue:S.value,"onUpdate:modelValue":t[1]||(t[1]=a=>S.value=a),"play-button":"",class:"full",onPlay:t[2]||(t[2]=a=>L(S.value))},{default:m(()=>[c(O,null,{default:m(()=>t[11]||(t[11]=[y("build")])),_:1,__:[11]}),t[12]||(t[12]=u("span",null,"Omroep maken",-1))]),_:1,__:[12]},8,["modelValue"]),(n(!0),f(I,null,R([V(M).default.sounds.filter(a=>!a.startsWith("auditorium")),V(M).default.sounds.filter(a=>a.startsWith("auditorium")),...V(o).map(a=>{var C;return(C=V(M)[a.toLowerCase()])==null?void 0:C.additionalSounds})],a=>te((n(),f("div",Ut,[(n(!0),f(I,null,R(a,C=>(n(),f("button",{onClick:re=>L([{spriteName:C,offset:0}]),class:G({translucent:C!=="chime"&&!V(o).some(re=>V(M)[re].sounds.includes(C))})},[C==="chime"?(n(),E(O,{key:0,fill:!0,style:{"--size":"14px","vertical-align":"middle"}},{default:m(()=>t[13]||(t[13]=[y(" music_note")])),_:1,__:[13]})):(n(),f("span",Mt,k(V(z)(C).name),1))],10,Ct))),256))],512)),[[me,(a==null?void 0:a.length)>0]])),256))]),u("fieldset",null,[t[17]||(t[17]=u("legend",null,"Regels",-1)),c(se,{class:"secondary full",onClick:t[3]||(t[3]=a=>b.value=!0)},{default:m(()=>[c(O,null,{default:m(()=>t[15]||(t[15]=[y("edit")])),_:1,__:[15]}),u("span",null,[t[16]||(t[16]=y("Regels bewerken ")),V(l).filter(a=>a.enabled).length?(n(),f("small",Dt,"(eigen regels: "+k(V(l).filter(a=>a.enabled).length)+" actief)",1)):N("",!0)])]),_:1})])]),_:1,__:[18]})])]),c(oe,null,{default:m(()=>[b.value?(n(),E(he,{key:0,onDismiss:t[7]||(t[7]=a=>b.value=!1)},{default:m(()=>[c(we,null,{default:m(()=>[c(ue,{value:"Standaardregels"},{default:m(()=>[c(ae,{modelValue:V(e),"onUpdate:modelValue":t[4]||(t[4]=a=>Z(e)?e.value=a:null),toggleOnly:!0},null,8,["modelValue"])]),_:1}),c(ue,{value:"Eigen regels"},{default:m(()=>[c(ae,{modelValue:V(l),"onUpdate:modelValue":t[5]||(t[5]=a=>Z(l)?l.value=a:null),toggleOnly:!1},null,8,["modelValue"])]),_:1})]),_:1}),c(se,{class:"full",onClick:t[6]||(t[6]=a=>{A(),b.value=!1}),style:{"margin-top":"16px"}},{default:m(()=>[c(O,null,{default:m(()=>t[19]||(t[19]=[y("refresh")])),_:1,__:[19]}),t[20]||(t[20]=u("span",null,"Omroepen klaarzetten",-1))]),_:1,__:[20]})]),_:1})):N("",!0)]),_:1}),V(ye)?(n(),f("div",At," Laat los om bestand te uploaden ")):N("",!0),u("div",{ref_key:"audios",ref:w,id:"audios"},null,512)],512)}}}),qt=Q(Bt,[["__scopeId","data-v-6775e913"]]);export{qt as default};
