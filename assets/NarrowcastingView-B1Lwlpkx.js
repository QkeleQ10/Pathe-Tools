var re=Object.defineProperty;var ie=(f,e,o)=>e in f?re(f,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):f[e]=o;var w=(f,e,o)=>ie(f,typeof e!="symbol"?e+"":e,o);import{a as de,_ as ue,u as pe}from"./server-C8iByn8A.js";import{d as X,r as V,c as b,F as q,q as G,h as P,g as U,w as j,m as Q,b as s,K as me,k as ee,j as B,y as te,l as y,f as S,o as c,_ as ne,e as ge,i as ce,u as d,v as ve,s as J}from"./index-CHAxOeyB.js";import{b as se,a as ye}from"./FileUploadBlock-C95wcWgp.js";import{u as oe,I as be,_ as fe}from"./TimetableUploadSection-CB7vtTih.js";import"./nl-C2wEvD9T.js";class M{constructor(e=65535,o=65535,a){w(this,"packet");let l;if(a instanceof Uint8Array)l=a;else if(Array.isArray(a)){l=new Uint8Array(a.reduce((p,k)=>p+k.messageBody.length,0));let m=0;for(const p of a)l.set(p.messageBody,m),m+=p.messageBody.length}else l=a.messageBody;const u=new Uint8Array(9);u.set([170,187,e>>8,e&255,o>>8,o&255,l.length>>8,l.length&255,e>>8^e&255^o>>8^o&255^l.length>>8^l.length&255]);const g=new Uint8Array(1);g.set([l.reduce((m,p)=>m^p,0)]),this.packet=new Uint8Array(u.length+l.length+g.length),this.packet.set(u),this.packet.set(l,u.length),this.packet.set(g,u.length+l.length)}toString(){return Array.from(this.packet).map(e=>e.toString(16).padStart(2,"0")).join(" ").toUpperCase()}}class Y{constructor(){w(this,"messageBody")}}w(Y,"functionCode",0);class N extends Y{constructor(e){super();let o;if(e instanceof Uint8Array)o=e;else if(Array.isArray(e)){o=new Uint8Array(e.reduce((u,g)=>u+g.messageBody.length,0));let l=0;for(const u of e)o.set(u.messageBody,l),l+=u.messageBody.length}else o=e.messageBody;const a=new Uint8Array(1+o.length);a.set([this.constructor.functionCode]),a.set(o,1),this.messageBody=a}}w(N,"functionCode",0);class le extends Y{constructor(e){super();const o=new Uint8Array(8);o.set([this.constructor.functionCode]),o.set([e.getFullYear()-2e3,e.getMonth()+1,e.getDate(),e.getDay(),e.getHours(),e.getMinutes(),e.getSeconds()],1),this.messageBody=o}}w(le,"functionCode",1);class D{constructor(){w(this,"messageBody")}}w(D,"commandCode",0);const O=class O extends D{constructor(){super();const e=new Uint8Array(1);e.set([O.commandCode]),this.messageBody=e}};w(O,"commandCode",1);let R=O;const Z=class Z extends D{constructor(e=0,o=3,a=0,l=0,u=0,g){super();const m=ae(g),p=new Uint8Array(6+m.length+1);p.set([Z.commandCode]),p.set([e,o,a,l,u],1),p.set(m,6),p.set([0],p.length-1),this.messageBody=p}};w(Z,"commandCode",3);let x=Z;const E=class E extends D{constructor(e=1,o=0,a=3,l=0,u=0,g=0){super();const m=new Uint8Array(7);m.set([E.commandCode]),m.set([e,o,a,l,u,g],1),this.messageBody=m}};w(E,"commandCode",4);let z=E;const F=class F extends D{constructor(e=0,o=0,a=9){super();const l=new Uint8Array(5);l.set([F.commandCode]),l.set([e>>8,e&255,o,a],1),this.messageBody=l}};w(F,"commandCode",7);let H=F;const K=class K extends D{constructor(e,o=0,a=4,l=0,u=3,g=0,m=0,p=0){super();const k=ae(e),i=new Uint8Array(8+k.length+1);i.set([K.commandCode]),i.set([o,a,l,u,g,m,p],1),i.set(k,8),i.set([0],i.length-1),this.messageBody=i}};w(K,"commandCode",8);let L=K;const W=class W extends D{constructor(){super();const e=new Uint8Array(1);e.set([W.commandCode]),this.messageBody=e}};w(W,"commandCode",31);let I=W;const he={"":0,"":1,"":2,"":3,"":4,"":5,"":6,"\x07":7,"\b":8,"	":9,"\n":10,"\v":11,"\f":12,"\r":13,"":14,"":15,"":16,"":17,"":18,"":19,"":20,"":21,"":22,"":23,"":24,"":25,"":26,"\x1B":27,"":28,"":29,"":30,"":31," ":32,"!":33,'"':34,"#":35,$:36,"%":37,"&":38,"'":39,"(":40,")":41,"*":42,"+":43,",":44,"-":45,".":46,"/":47,0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,":":58,";":59,"<":60,"=":61,">":62,"?":63,"@":64,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,"[":91,"\\":92,"]":93,"^":94,_:95,"`":96,a:97,b:98,c:99,d:100,e:101,f:102,g:103,h:104,i:105,j:106,k:107,l:108,m:109,n:110,o:111,p:112,q:113,r:114,s:115,t:116,u:117,v:118,w:119,x:120,y:121,z:122,"{":123,"|":124,"}":125,"~":126,"":127,"Â€":128,"Â":129,"Â‚":130,"Âƒ":131,"Â„":132,"Â…":133,"Â†":134,"Â‡":135,"Âˆ":136,"Â‰":137,"ÂŠ":138,"Â‹":139,"ÂŒ":140,"Â":141,"ÂŽ":142,"Â":143,"Â":144,"Â‘":145,"Â’":146,"Â“":147,"Â”":148,"Â•":149,"Â–":150,"Â—":151,"Â˜":152,"Â™":153,"Âš":154,"Â›":155,"Âœ":156,"Â":157,"Âž":158,"ÂŸ":159,"Â ":160,"Â¡":161,"Â¢":162,"Â£":163,"Â¤":164,"Â¥":165,"Â¦":166,"Â§":167,"Â¨":168,"Â©":169,Âª:170,"Â«":171,"Â¬":172,"Â­":173,"Â®":174,"Â¯":175,"Â°":176,"Â±":177,"Â²":178,"Â³":179,"Â´":180,Âµ:181,"Â¶":182,"Â·":183,"Â¸":184,"Â¹":185,Âº:186,"Â»":187,"Â¼":188,"Â½":189,"Â¾":190,"Â¿":191,Ã€:192,Ã:193,Ã‚:194,Ãƒ:195,Ã„:196,Ã…:197,Ã†:198,Ã‡:199,Ãˆ:200,Ã‰:201,ÃŠ:202,Ã‹:203,ÃŒ:204,Ã:205,ÃŽ:206,Ã:207,Ã:208,Ã‘:209,Ã’:210,Ã“:211,Ã”:212,Ã•:213,Ã–:214,"Ã—":215,Ã˜:216,Ã™:217,Ãš:218,Ã›:219,Ãœ:220,Ã:221,Ãž:222,ÃŸ:223,Ã :224,Ã¡:225,Ã¢:226,Ã£:227,Ã¤:228,Ã¥:229,Ã¦:230,Ã§:231,Ã¨:232,Ã©:233,Ãª:234,Ã«:235,Ã¬:236,Ã­:237,Ã®:238,Ã¯:239,Ã°:240,Ã±:241,Ã²:242,Ã³:243,Ã´:244,Ãµ:245,Ã¶:246,"Ã·":247,Ã¸:248,Ã¹:249,Ãº:250,Ã»:251,Ã¼:252,Ã½:253,Ã¾:254,Ã¿:255};function ae(f){const e=f.split("").map(o=>he[o]??0);return new Uint8Array(e)}const we={class:"flex"},ke={class:"flex"},Te={style:{width:"48ch"}},_e={style:{width:"16ch"}},xe=X({__name:"CinemecTimetableTest",setup(f){const e=se("history"),o=oe(),a=V(!!e.prototype),l=V("http://localhost:5000/send-bytes"),u=V("10.10.87.81"),g=V("10.10.87.82"),m=V("9100"),p=V(!1),k={testMessage:()=>new M(null,null,new N([new R,new z(2,null,3,null,55,0),new x(null,2,0,0,2,T("Welkom bij PathÃ© Utrecht Leidsche Rijn!",60)),new x(null,3,0,0,3,T("De timetable toont momenteel geen actuele",60)),new x(null,3,0,0,4,T("informatie. Raadpleeg uw ticket of de",60)),new x(null,3,0,0,5,T("schermen bij de kassa voor het zaalnummer.",60)),new H(null,4,9),new L("De Rooftop is weer geopend! Check pathÃ©.nl of de PathÃ©-app voor alle voorstellingen.",6,7,null,1,null,0,8),new I])),setClock:()=>new M(null,null,new le(new Date)),thankYou:()=>new M(null,null,new N([new R,new z(2,null,3,null,55,0),new x(null,3,0,0,3,T("Hartelijk dank voor je filmbezoek!",60)),new x(null,3,0,0,4,T("Wij hopen dat je genoten hebt.",60)),new x(null,3,0,0,5,T("Graag tot ziens bij",60)),new x(null,2,0,0,6,T("PathÃ© Utrecht Leidsche Rijn",60)),new H(null,4,9),new L("De Rooftop is weer geopend! Check pathÃ©.nl of de PathÃ©-app voor alle voorstellingen.",6,7,null,1,null,0,8),new I])),schedule:()=>{const v=o.table.filter(n=>n.scheduledTime.getTime()-Date.now()>-9e5).sort((n,h)=>n.scheduledTime.getTime()-h.scheduledTime.getTime()).slice(0,6);return v.length?new M(null,null,new N([new R,new z(2,null,3,null,55,0),new x(null,2,0,0,1,"Welkom bij PathÃ© Utrecht Leidsche Rijn!                 Zaal"),...v.map((n,h)=>new x(null,3,0,0,h+2,`${S(n.scheduledTime,"HH:mm")} ${n.title.substring(0,38).padEnd(38)} ${n.scheduledTime.getTime()-Date.now()<3e5?"~F;~C1;":"~C0;"}${n.scheduledTime.getTime()-Date.now()<-54e4?"  is gestart":"gaat starten"} ~N;~I;~C3;${n.auditoriumNumber.toString().substring(0,2).padStart(2)}`)),new H(null,4,9),new L("De Rooftop is weer geopend! Check pathÃ©.nl of de PathÃ©-app voor alle voorstellingen.",6,7,null,1,null,0,8),new I])):k.thankYou()}},i=V(k.testMessage().toString());async function t(){if(u.value){let v=await fetch(l.value,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({ip:u.value,port:m.value,hex:i.value})});console.log(v)}if(g.value){let v=await fetch(l.value,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({ip:g.value,port:m.value,hex:i.value})});console.log(v)}p.value&&setTimeout(()=>{i.value=k.schedule().toString(),t()},6e4)}function C(v){return v.trim().split(/\s+/).map(_=>{const $=parseInt(_,16);return String.fromCharCode($)}).join("")}function T(v,n,h=" "){const _=Math.floor((n-v.length)/2);return h.repeat(_)+v+h.repeat(n-v.length-_)}return(v,n)=>{const h=te,_=de,$=ue;return c(),b(q,null,[a.value?(c(),G($,{key:0,onDismiss:n[6]||(n[6]=r=>a.value=!1)},{default:j(()=>[Q(s("textarea",{"onUpdate:modelValue":n[0]||(n[0]=r=>i.value=r),identifier:"input"},null,512),[[me,i.value]]),s("div",we,[(c(!0),b(q,null,ee(Object.keys(k),r=>(c(),G(h,{class:"secondary",onClick:A=>i.value=k[r]().toString()},{default:j(()=>[y(B(r),1)]),_:2},1032,["onClick"]))),256))]),s("div",ke,[s("pre",Te,B(i.value),1),s("pre",_e,B(C(i.value).replace(/[\n\r\t]/g," ").match(/.{1,16}/g).join(`
`)),1)]),U(_,{modelValue:l.value,"onUpdate:modelValue":n[1]||(n[1]=r=>l.value=r),identifier:"host"},{default:j(()=>n[8]||(n[8]=[s("span",null,"host",-1)])),_:1,__:[8]},8,["modelValue"]),U(_,{modelValue:u.value,"onUpdate:modelValue":n[2]||(n[2]=r=>u.value=r),identifier:"ip"},{default:j(()=>n[9]||(n[9]=[s("span",null,"ip",-1)])),_:1,__:[9]},8,["modelValue"]),U(_,{modelValue:g.value,"onUpdate:modelValue":n[3]||(n[3]=r=>g.value=r),identifier:"ip2"},{default:j(()=>n[10]||(n[10]=[s("span",null,"ip2",-1)])),_:1,__:[10]},8,["modelValue"]),U(_,{modelValue:m.value,"onUpdate:modelValue":n[4]||(n[4]=r=>m.value=r),identifier:"port"},{default:j(()=>n[11]||(n[11]=[s("span",null,"port",-1)])),_:1,__:[11]},8,["modelValue"]),U(be,{modelValue:p.value,"onUpdate:modelValue":n[5]||(n[5]=r=>p.value=r),identifier:"repeat"},{default:j(()=>n[12]||(n[12]=[s("span",null,"repeat",-1)])),_:1,__:[12]},8,["modelValue"]),U(h,{onClick:t},{default:j(()=>n[13]||(n[13]=[y("sendRequest")])),_:1,__:[13]})]),_:1})):P("",!0),U(h,{class:"secondary",onClick:n[7]||(n[7]=r=>a.value=!0),style:{opacity:"0.2"}},{default:j(()=>n[14]||(n[14]=[y("Prototype-test")])),_:1,__:[14]})],64)}}}),Ue=ne(xe,[["__scopeId","data-v-ca8b3789"]]),je={style:{display:"grid","grid-template-columns":"1fr auto",gap:"32px"}},Ce={id:"instructions"},Be={key:0},Ve={key:1},Ae={key:2},De={key:3},$e={key:4},Se={key:5},Pe={key:6},Re={style:{"max-width":"560px"}},ze={key:0},He={key:1},Le={class:"block",id:"matrix-display"},Ie={class:"matrix-clock"},Me={class:"col"},Ne={class:"col"},Oe={class:"col"},Ze={key:0,class:"dropzone"},Ee=X({__name:"NarrowcastingView",setup(f){const e=oe(),o=pe(),a=se("history"),l=V(!1);e.$subscribe(()=>{var C;if(!a.download||!((C=e.table)!=null&&C.length)||u.value.length<10||l.value)return;const i=new Blob([u.value],{type:"text/plain"}),t=document.createElement("a");t.href=URL.createObjectURL(i),t.download="timetable.xml",t.click(),URL.revokeObjectURL(t.href),l.value=!0});const u=ge(()=>{const i=C=>"  ".repeat(C),t=e.table.map((C,T)=>g(C,T).split("><").join(`>
${i(2)}<`)).join(`
${i(1)}`);return`<voorstellingen>
${i(1)}${t}
</voorstellingen>`});function g(i,t){return`<Shows><ID type="Long Integer">${t}</ID><DatumVan type="Date/Time">${S(i.scheduledTime,"dd-MM-yyyy")}</DatumVan><DatumTot type="Date/Time">${S(i.scheduledTime,"dd-MM-yyyy")}</DatumTot><Tijd type="Date/Time">${S(i.scheduledTime,"HH:mm")}</Tijd><Titel type="Text">${i.playlist}</Titel><Zaal type="Text">${i.auditoriumNumber}</Zaal><Kleur type="Long Integer">3</Kleur><Permanent type="Long Integer">1</Permanent></Shows>`}function m(){a.url="https://pathe-tools-server.onrender.com",o.url="https://pathe-tools-server.onrender.com",e.connect()}const p=V(null),{isOverDropZone:k}=ye(p,{onDrop:e.filesUploaded,multiple:!1});return(i,t)=>{var h,_,$;const C=ce,T=fe,v=te,n=Ue;return c(),b("main",{ref_key:"main",ref:p},[U(C),U(T),s("section",null,[s("div",je,[s("div",Ce,[t[12]||(t[12]=s("h2",null,"Timetable vullen",-1)),d(o).url==="http://localhost:3541"?(c(),b("div",Be,[t[1]||(t[1]=s("p",null," Het serveradres is niet ingesteld. ",-1)),U(v,{class:"primary",onClick:m},{default:j(()=>t[0]||(t[0]=[y("Oplossen")])),_:1,__:[0]})])):["send-error","receive-error","no-credentials","no-connection","error"].includes(d(e).status)?(c(),b("div",Ve,[t[3]||(t[3]=s("p",null," Er is geen verbinding met de server. Controleer de inloggegevens. ",-1)),U(v,{class:"primary",onClick:d(e).connect},{default:j(()=>t[2]||(t[2]=[y("Opnieuw verbinden")])),_:1,__:[2]},8,["onClick"])])):["sending","receiving"].includes(d(e).status)?(c(),b("div",Ae,t[4]||(t[4]=[s("p",null," Er wordt verbinding gemaakt. Een ogenblik geduld... ",-1)]))):!d(a).download&&!d(e).table.length&&["sent","received"].includes(d(e).status)?(c(),b("div",De,t[5]||(t[5]=[s("p",null,[y(" Upload een "),s("b",null,"TSV"),y("-bestand uit RosettaBridge (optie "),s("b",null,"Dates - ISO"),y(") met de knop of door hem hierheen te slepen. Let op dat je het bestand voor de juiste datum uploadt. ")],-1)]))):d(a).download&&!d(e).table.length&&["sent","received"].includes(d(e).status)?(c(),b("div",$e,t[6]||(t[6]=[s("p",null," Er is nog geen bestand geÃ¼pload! Ga naar de RosettaBridge-PC en open deze pagina. ",-1)]))):!d(a).download&&d(e).table.length&&["sent","received"].includes(d(e).status)?(c(),b("div",Se,[s("p",null,[y(" De weergegeven gegevens zijn "+B(d(e).status==="sent"?"geÃ¼pload naar":"al aanwezig op")+" de server. ",1),t[7]||(t[7]=s("br",null,null,-1)),t[8]||(t[8]=s("br",null,null,-1)),t[9]||(t[9]=y(" Als dit het juiste bestand is, ga dan naar de Timetable-PC en doe het volgende: "))]),t[10]||(t[10]=s("ol",null,[s("li",null,"Zorg ervoor dat het softwareprogramma 'CineMec TimeTable' (Ã©Ã©n keer) open staat."),s("li",null,"Dubbelklik op het bestandje op het bureaublad genaamd 'Voorstellingen ophalen van PathÃ© Tools.bat'.")],-1))])):d(a).download&&d(e).table.length&&["sent","received"].includes(d(e).status)?(c(),b("div",Pe,t[11]||(t[11]=[s("p",null," De weergegeven gegevens zijn aanwezig op de server. Er wordt nu een bestand gedownload. Zorg ervoor dat dit bestand wordt opgeslagen als 'timetable.xml' in de standaarddownloadmap, als dat niet automatisch gebeurt. Klik eventueel op 'Behouden'. ",-1)]))):P("",!0),U(n)]),Q(s("div",null,[t[24]||(t[24]=s("h2",null,"Voorbeeld",-1)),s("p",Re,[t[14]||(t[14]=y(" Dit is slechts een voorbeeld. Deze pagina staat ")),t[15]||(t[15]=s("u",null,"niet",-1)),t[16]||(t[16]=y(" in directe verbinding met de Timetable.")),t[17]||(t[17]=s("br",null,null,-1)),t[18]||(t[18]=s("br",null,null,-1)),((h=d(e).table.sort((r,A)=>r.scheduledTime.getTime()-A.scheduledTime.getTime())[0])==null?void 0:h.scheduledTime)>new Date(new Date().setHours(0,0,0,0)+24*60*60*1e3)?(c(),b("span",ze,t[13]||(t[13]=[y(" Als je deze gegevens inlaadt in de Timetable, dan worden ze pas vanaf middernacht weergegeven. "),s("br",null,null,-1),s("br",null,null,-1)]))):P("",!0),d(e).table.some(r=>r.playlist.length>37)?(c(),b("span",He," Sommige titels zijn te lang en moeten mogelijk nog worden verkort ("+B(d(e).table.filter(r=>r.playlist.length>37).length)+"Ã—). ",1)):P("",!0)]),s("div",Le,[t[22]||(t[22]=s("span",{id:"matrix-display-title"},"PathÃ© Timetable",-1)),s("pre",Ie,B(d(S)((($=(_=d(e).table)==null?void 0:_[0])==null?void 0:$.scheduledTime.getTime())+84e4||new Date,"HH:mm")),1),t[23]||(t[23]=s("pre",{class:"matrix-row green"},"        Welkom bij PathÃ© Utrecht Leidsche Rijn!         Zaal",-1)),(c(!0),b(q,null,ee(d(e).table.sort((r,A)=>r.scheduledTime.getTime()-A.scheduledTime.getTime()),(r,A)=>(c(),b("pre",{class:J(["matrix-row",{overflowing:r.playlist.length>37}])},[s("div",Me,B(d(S)(r.scheduledTime,"HH:mm")),1),t[19]||(t[19]=y()),s("div",Ne,B(r.playlist),1),t[20]||(t[20]=y()),s("div",{class:J(["col",{blink:A===1}])},B(A===0?"is gestart":A===1?"gaat beginnen":""),3),t[21]||(t[21]=y()),s("div",Oe,B(r.auditoriumNumber||"?"),1)],2))),256))])],512),[[ve,d(e).table.length&&["sent","received"].includes(d(e).status)]])])]),d(k)?(c(),b("div",Ze," Laat los om bestand te uploaden ")):P("",!0)],512)}}}),Je=ne(Ee,[["__scopeId","data-v-181798c2"]]);export{Je as default};
