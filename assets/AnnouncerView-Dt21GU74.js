var we=Object.defineProperty;var Te=(n,u,m)=>u in n?we(n,u,{enumerable:!0,configurable:!0,writable:!0,value:m}):n[u]=m;var H=(n,u,m)=>Te(n,typeof u!="symbol"?u+"":u,m);import{_ as te,a as re}from"./server-jGVXSnHF.js";import{b as de,_ as Ve,a as he}from"./InputNumber-DLh8h-5E.js";import{d as X,A as W,B as F,c as y,F as B,q as I,h as N,g as p,w as d,a as ee,b as s,C as le,l as g,D as be,T as ie,k as R,y as oe,o as a,j as S,u as x,_ as Q,m as me,E as Oe,r as z,s as J,G as ue,H as Se,I as ke,i as xe,J as $e,K as Ne,p as Z,f as K,v as Ue}from"./index-BnRLuoRB.js";import{a as fe,u as Me,_ as Ce}from"./TimetableUploadSection-B3W9wmQz.js";import{u as Y,a as De,_ as Ae}from"./FileUploadBlock-Qgf1xRFa.js";import{_ as Be}from"./Chip-CMdt4H52.js";import"./nl-CiMRTCx0.js";const Ie="/Pathe-Tools/assets/rosetta-Cn53EfYD.ogg",Ee="/Pathe-Tools/assets/gerwim-CqHIXSuO.ogg",Re="/Pathe-Tools/assets/jaron-CS_9Sx9l.ogg",je="/Pathe-Tools/assets/danique-C_bjxFfD.ogg",Le="/Pathe-Tools/assets/quinten-DogOe9-k.ogg";class q{constructor(u){H(this,"name");H(this,"language");H(this,"file");H(this,"sprite");this.name=u.name,this.language=u.language,this.file=u.file,this.sprite=u.sprite}get sounds(){return Object.keys(this.sprite)}get additionalSounds(){return this.sounds.filter(u=>!A.default.sounds.includes(u))}}const A={default:new q({name:"Rosetta",language:"nl",file:Ie,sprite:{auditorium01:[0,937.0294784580499],auditorium02:[1200,982.9931972789117],auditorium03:[2400,863.6281179138323],auditorium04:[3600,1022.8571428571427],auditorium05:[5800,1023.1065759637188],auditorium06:[8e3,1016.2585034013603],auditorium07:[10200,1187.2335600907036],auditorium08:[12400,1109.2290249433106],auditorium09:[14600,1185.2154195011337],auditorium10:[16800,959.9773242630398],auditorium11:[18000.000000000004,1122.6077097505681],auditorium12:[20200.000000000004,1185.8049886621309],auditorium13:[22400.000000000004,1159.6825396825388],auditorium14:[24600,1169.5918367346926],auditorium15:[26800,1240.1360544217682],auditorium16:[29e3,1161.0884353741503],auditorium17:[31200,1213.2426303854907],auditorium18:[33400.00000000001,1123.990929705215],auditorium19:[35600.00000000001,1342.7664399092976],auditorium20:[37800.000000000015,1263.8321995464848],chime:[40000.000000000015,3084.51247165533],credits:[44200.000000000015,924.7165532879791],end:[45400.000000000015,1289.478458049885],mainshow:[47600.00000000001,1445.963718820863],preshow:[49800.000000000015,1364.3990929705226],start:[52000.000000000015,686.9841269841288]}}),gerwim:new q({name:"Gerwim",language:"nl",file:Ee,sprite:{auditorium01:[0,824.9659863945578],auditorium02:[1200,870.907029478458],auditorium03:[2400,790.2040816326532],auditorium04:[3600,886.825396825397],auditorium05:[4800,838.526077097506],auditorium06:[6e3,866.7573696145121],auditorium07:[7199.999999999999,987.7777777777776],auditorium10:[8399.999999999998,665.6689342403635],credits:[9600,936.5532879818588],start:[10799.999999999998,638.9342403628114]}}),jaron:new q({name:"Jaron",language:"nl",file:Re,sprite:{auditorium01:[0,996.2585034013606],auditorium02:[1200,977.2562358276645],auditorium03:[2400,1053.9229024943313],auditorium04:[4600,1109.8866213151925],auditorium05:[6799.999999999999,1125.5328798185947],auditorium06:[9e3,1083.7641723356005],auditorium07:[11200,1070.2947845804988],auditorium08:[13399.999999999998,1134.9206349206345],auditorium09:[15599.999999999998,1259.2517006802736],auditorium10:[17800,750.5895691609971],credits:[19e3,920.6575963718819],end:[20200,1177.0748299319714],finalshow:[22400,1377.0068027210875],mainshow:[24599.999999999996,1302.0634920634925],start:[26799.999999999996,737.8458049886625]}}),danique:new q({name:"Danique",language:"nl",file:je,sprite:{auditorium01:[0,737.9591836734694],auditorium02:[1200,820.340136054422],auditorium03:[2400.0000000000005,677.482993197279],auditorium04:[3600.0000000000005,822.6530612244902],auditorium05:[4800.000000000001,810.5442176870747],auditorium06:[6000.000000000001,795.4875283446717],auditorium07:[7200.000000000001,926.8027210884355],auditorium08:[8400,871.0430839002274],auditorium09:[9600.000000000002,941.8820861677997],auditorium10:[10800,689.569160997733],credits:[12000.000000000002,786.3718820861685],end:[13200.000000000004,1149.2743764172335],start:[15400.000000000002,520.2040816326523]}}),quinten:new q({name:"Quinten",language:"nl",file:Le,sprite:{auditorium01:[0,743.7414965986394],auditorium02:[1200,756.5759637188207],auditorium03:[2400,732.0861678004537],auditorium04:[3600,725.6235827664397],auditorium05:[4800,846.485260770975],auditorium06:[6e3,790.9297052154196],auditorium07:[7200,939.3877551020404],auditorium08:[8400,841.7006802721083],auditorium09:[9600,1026.190476190477],auditorium10:[11800,711.0204081632645],auditorium11:[13e3,863.2653061224485],auditorium12:[14200,1008.8208616780037],auditorium13:[16400,869.6371882086175],auditorium14:[17599.999999999996,961.0430839002255],auditorium15:[18799.999999999996,1017.5283446712023],auditorium16:[20999.999999999996,1057.664399092971],auditorium17:[23199.999999999996,1032.1315192743762],auditorium18:[25399.999999999996,958.7074829931978],auditorium19:[26599.999999999993,1050.8616780045336],auditorium20:[28799.999999999993,1045.6462585033996],credits:[30999.999999999993,690.6122448979595],end:[32199.999999999996,1004.1723356009059],intermission:[34399.99999999999,568.7301587301619],mainshow:[35599.99999999999,1155.2607709750546],preshow:[37799.99999999999,1171.224489795918],start:[39999.99999999999,547.0068027210857]}})};function G(n){const u={start:"start",mainshow:"start hoofdfilm",credits:"aftiteling",end:"einde voorstelling",preshow:"start voorprogramma",finalshow:"laatste voorstelling",chime:"♪"};n=n.toLowerCase().trim();let m=n.replace(/\?+/g,""),_=u[m]||m,w=Object.values(A).some(e=>e.sounds.includes(m)),h=1/Math.pow(2,(n.match(/\?+/g)||[""])[0].length);n.includes("|")&&(_=n.split("|").map(e=>G(e).name).join("|"),w=_.split("|").every(e=>e!==m),h=1);let k=m.match(/^(auditorium)([0-9]+|(#))$/);return k&&(_=`zaal ${k[2]=="#"?"#":Number(k[2])}`,w=!0),{id:m,name:_,valid:w,probability:h}}const Pe={key:0,class:"segment-list"},He=["value"],qe={key:1},ze={class:"flex",style:{"margin-top":"16px"}},Fe=X({__name:"AnnouncementBuilder",props:W({noButton:{type:Boolean,default:!1},playButton:{type:Boolean,default:!1}},{modelValue:{},modelModifiers:{},show:{type:Boolean,default:!1},showModifiers:{}}),emits:W(["play"],["update:modelValue","update:show"]),setup(n,{emit:u}){const m=F(n,"modelValue"),_=F(n,"show"),w=u,h=[...new Set(Object.values(A).flatMap(l=>l.sounds))];function k(){m.value.push({spriteName:"",offset:0})}function e(l){return l.charAt(0).toUpperCase()+l.slice(1)}return(l,o)=>{const b=le,V=oe,$=re,C=de,E=te;return a(),y(B,null,[n.noButton?N("",!0):(a(),I(V,be({key:0,class:"secondary announcement-builder-button",onClick:o[0]||(o[0]=D=>_.value=!0)},l.$attrs),{default:d(()=>[ee(l.$slots,"default",{},()=>[p(b,null,{default:d(()=>o[3]||(o[3]=[g("build")])),_:1,__:[3]}),o[4]||(o[4]=s("span",null,"Omroep bewerken",-1))],!0)]),_:3},16)),p(ie,null,{default:d(()=>[_.value?(a(),I(E,{key:0,onDismiss:o[2]||(o[2]=D=>_.value=!1)},{default:d(()=>[o[10]||(o[10]=s("h3",null,"Omroeponderdelen",-1)),m.value.length?(a(),y("ul",Pe,[(a(!0),y(B,null,R(m.value,(D,i)=>(a(),y("li",{class:"segment",key:i},[p($,{class:"no-label",identifier:"spriteName"+i,modelValue:D.spriteName,"onUpdate:modelValue":M=>D.spriteName=M,spellcheck:!1,autocomplete:"off",autocapitalize:"off"},{datalist:d(()=>[(a(),y(B,null,R(h,M=>s("option",{key:M,value:M},S(e(x(G)(M).name)),9,He)),64))]),_:2},1032,["identifier","modelValue","onUpdate:modelValue"]),p(C,{class:"no-label",identifier:"offset"+i,modelValue:D.offset,"onUpdate:modelValue":M=>D.offset=M,unit:"ms"},null,8,["identifier","modelValue","onUpdate:modelValue"]),p(b,{style:{float:"right",cursor:"pointer",padding:"2px"},onClick:M=>m.value.splice(i,1)},{default:d(()=>o[5]||(o[5]=[g(" delete")])),_:2,__:[5]},1032,["onClick"])]))),128))])):(a(),y("p",qe," Geen onderdelen gevonden. ")),s("div",ze,[p(V,{class:"secondary add-rule",onClick:k},{default:d(()=>[p(b,null,{default:d(()=>o[6]||(o[6]=[g("add")])),_:1,__:[6]}),o[7]||(o[7]=g(" Nieuw onderdeel "))]),_:1,__:[7]}),n.playButton?(a(),I(V,{key:0,class:"secondary add-rule",onClick:o[1]||(o[1]=D=>w("play"))},{default:d(()=>[p(b,null,{default:d(()=>o[8]||(o[8]=[g("play_arrow")])),_:1,__:[8]}),o[9]||(o[9]=g(" Afspelen "))]),_:1,__:[9]})):N("",!0)])]),_:1,__:[10]})):N("",!0)]),_:1})],64)}}}),pe=Q(Fe,[["__scopeId","data-v-b8b48b82"]]),Ge=["for"],Xe={class:"title"},We=["id"],Je=X({__name:"InputSelect",props:W({identifier:{}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(n){const u=F(n,"modelValue");return(m,_)=>(a(),y("label",{class:"input select-input",for:m.identifier},[s("div",Xe,[ee(m.$slots,"default",{},void 0,!0)]),me(s("select",{id:m.identifier,"onUpdate:modelValue":_[0]||(_[0]=w=>u.value=w)},[ee(m.$slots,"options",{},void 0,!0)],8,We),[[Oe,u.value]])],8,Ge))}}),Qe=Q(Je,[["__scopeId","data-v-15be24ca"]]),Ze={key:1,class:"input timing-input"},Ke=["value"],Ye={key:2},et={style:{opacity:".5"}},tt={key:0},lt={key:1},it={key:2},ot={style:{opacity:".5"}},nt={key:0,style:{opacity:".5"}},st={key:0},at={key:1},ut={key:2},rt={key:3},dt={key:4},mt={key:1,style:{opacity:".5"}},ft={key:1},pt=X({__name:"RuleList",props:W({toggleOnly:{type:Boolean,default:!1}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(n){const u=z(!1),m=z(!1),_=F(n,"modelValue"),w={scheduledTime:"inloop",showTime:"start",mainShowTime:"start hoofdfilm",intermissionTime:"pauze",creditsTime:"aftiteling",endTime:"einde voorstelling"};function h(){const k={id:Date.now().toString(),enabled:!0,segments:[{spriteName:"chime",offset:-800},{spriteName:"auditorium#",offset:0}],trigger:{property:"scheduledTime",preponeMinutes:0},filter:{plfOnly:!1,lastShowOnly:!1,firstShowOnly:!1,playlistTitleIncludes:"",playlistTitleExcludes:""}};_.value.push(k)}return(k,e)=>{const l=le,o=fe,b=de,V=Qe,$=pe,C=re,E=te,D=oe;return a(),y(B,null,[_.value.length?(a(),y("ul",{key:0,class:J(["rule-list",{"toggle-only":n.toggleOnly}])},[(a(!0),y(B,null,R(_.value,(i,M)=>(a(),y("li",{class:J(["rule",{active:i.enabled}]),key:i.id},[n.toggleOnly?N("",!0):(a(),I(l,{key:0,style:{float:"right",cursor:"pointer",padding:"2px"},onClick:f=>_.value.splice(M,1)},{default:d(()=>e[4]||(e[4]=[g(" delete")])),_:2,__:[4]},1032,["onClick"])),p(o,{class:"toggler",identifier:i.id+"enabled",modelValue:i.enabled,"onUpdate:modelValue":f=>i.enabled=f},{default:d(()=>[g(S(i.name||"Eigen regel"),1)]),_:2},1032,["identifier","modelValue","onUpdate:modelValue"]),n.toggleOnly?(a(),y("p",Ye,[e[10]||(e[10]=g(" Timing: ")),s("span",et,[i.trigger.preponeMinutes>0?(a(),y("span",tt,[s("b",null,S(i.trigger.preponeMinutes)+" min.",1),e[7]||(e[7]=g(" vóór"))])):i.trigger.preponeMinutes<0?(a(),y("span",lt,[s("b",null,S(-i.trigger.preponeMinutes)+" min.",1),e[8]||(e[8]=g(" na"))])):(a(),y("span",it,"bij")),e[9]||(e[9]=g()),s("b",null,S(w[i.trigger.property]),1)])])):(a(),y("div",Ze,[e[6]||(e[6]=s("span",null,"Timing:",-1)),s("span",null,[p(b,{class:"no-label",identifier:i.id+"triggerPreponeMinutes",unit:"min.",modelValue:i.trigger.preponeMinutes,"onUpdate:modelValue":f=>i.trigger.preponeMinutes=f},null,8,["identifier","modelValue","onUpdate:modelValue"]),e[5]||(e[5]=g(" vóór ")),p(V,{class:"no-label",identifier:i.id+"triggerProperty",modelValue:i.trigger.property,"onUpdate:modelValue":f=>i.trigger.property=f},{options:d(()=>[(a(),y(B,null,R(w,(f,L)=>s("option",{key:L,value:L},S(f),9,Ke)),64))]),_:2},1032,["identifier","modelValue","onUpdate:modelValue"])])])),s("a",{onClick:e[0]||(e[0]=()=>{n.toggleOnly||(u.value=!0)})},[e[11]||(e[11]=s("u",null,"Omroep",-1)),e[12]||(e[12]=g(": ")),s("span",ot,S(i.segments.map(f=>x(G)(f.spriteName).name).join(" - ")),1)]),p($,{"no-button":"",modelValue:i.segments,"onUpdate:modelValue":f=>i.segments=f,show:u.value,"onUpdate:show":e[1]||(e[1]=f=>u.value=f)},{default:d(()=>[p(l,null,{default:d(()=>e[13]||(e[13]=[g("build")])),_:1,__:[13]}),s("span",null,S(i.segments.map(f=>x(G)(f.spriteName).name).join(" - ")),1)]),_:2},1032,["modelValue","onUpdate:modelValue","show"]),e[27]||(e[27]=s("br",null,null,-1)),!n.toggleOnly||Object.values(i.filter).some(f=>typeof f=="string"?f.length>0:f)?(a(),y("a",{key:3,onClick:e[2]||(e[2]=()=>{n.toggleOnly||(m.value=!0)})},[e[19]||(e[19]=s("u",null,"Filter",-1)),e[20]||(e[20]=g(": ")),Object.values(i.filter).some(f=>typeof f=="string"?f.length>0:f)?(a(),y("span",nt,[e[18]||(e[18]=g(" alleen ")),i.filter.lastShowOnly?(a(),y("b",st,"de laatste ")):N("",!0),i.filter.firstShowOnly?(a(),y("b",at,"de eerste ")):N("",!0),i.filter.plfOnly?(a(),y("b",ut,"4DX-")):N("",!0),g("voorstelling"+S(i.filter.lastShowOnly||i.filter.firstShowOnly?"":"en")+" ",1),i.filter.playlistTitleIncludes?(a(),y("span",rt,[e[14]||(e[14]=g("met ")),s("b",null,S(i.filter.playlistTitleIncludes),1),e[15]||(e[15]=g(" in de titel "))])):N("",!0),i.filter.playlistTitleExcludes?(a(),y("span",dt,[e[16]||(e[16]=g("zonder ")),s("b",null,S(i.filter.playlistTitleExcludes),1),e[17]||(e[17]=g(" in de titel "))])):N("",!0)])):(a(),y("span",mt,"elke voorstelling"))])):N("",!0),p(ie,null,{default:d(()=>[m.value?(a(),I(E,{key:0,onDismiss:e[3]||(e[3]=f=>m.value=!1),class:"filters"},{default:d(()=>[e[26]||(e[26]=s("h3",null,"Filter",-1)),p(o,{identifier:i.id+"plfOnly",modelValue:i.filter.plfOnly,"onUpdate:modelValue":f=>i.filter.plfOnly=f},{default:d(()=>e[21]||(e[21]=[g(" Alleen 4DX-voorstellingen ")])),_:2,__:[21]},1032,["identifier","modelValue","onUpdate:modelValue"]),p(o,{identifier:i.id+"lastShowOnly",modelValue:i.filter.lastShowOnly,"onUpdate:modelValue":f=>i.filter.lastShowOnly=f},{default:d(()=>e[22]||(e[22]=[g(" Alleen de laatste overeenkomst ")])),_:2,__:[22]},1032,["identifier","modelValue","onUpdate:modelValue"]),p(o,{identifier:i.id+"firstShowOnly",modelValue:i.filter.firstShowOnly,"onUpdate:modelValue":f=>i.filter.firstShowOnly=f},{default:d(()=>e[23]||(e[23]=[g(" Alleen de eerste overeenkomst ")])),_:2,__:[23]},1032,["identifier","modelValue","onUpdate:modelValue"]),p(C,{identifier:i.id+"playlistTitleIncludes",modelValue:i.filter.playlistTitleIncludes,"onUpdate:modelValue":f=>i.filter.playlistTitleIncludes=f},{default:d(()=>e[24]||(e[24]=[g(" Titel moet bevatten ")])),_:2,__:[24]},1032,["identifier","modelValue","onUpdate:modelValue"]),p(C,{identifier:i.id+"playlistTitleExcludes",modelValue:i.filter.playlistTitleExcludes,"onUpdate:modelValue":f=>i.filter.playlistTitleExcludes=f},{default:d(()=>e[25]||(e[25]=[g(" Titel mag niet bevatten ")])),_:2,__:[25]},1032,["identifier","modelValue","onUpdate:modelValue"])]),_:2,__:[26]},1024)):N("",!0)]),_:2},1024)],2))),128))],2)):(a(),y("p",ft," Geen regels gevonden. ")),n.toggleOnly?N("",!0):(a(),I(D,{key:2,class:"secondary add-rule",onClick:h},{default:d(()=>[p(l,null,{default:d(()=>e[28]||(e[28]=[g("add")])),_:1,__:[28]}),e[29]||(e[29]=g(" Nieuwe regel "))]),_:1,__:[29]}))],64)}}}),gt=Q(pt,[["__scopeId","data-v-5d7ffa21"]]),ct=X({__name:"VoicesSelector",props:{modelValue:{default:["default"]},modelModifiers:{}},emits:["update:modelValue"],setup(n){const u=F(n,"modelValue");function m(_,w){if(_)u.value.push(w);else{const h=u.value.indexOf(w);h>-1&&u.value.splice(h,1)}}return(_,w)=>{const h=fe;return a(!0),y(B,null,R(x(A),(k,e)=>(a(),I(h,{key:e,modelValue:u.value.includes(e),"onUpdate:modelValue":l=>m(l,e),identifier:e},{default:d(()=>[g(S(k.name),1)]),_:2},1032,["modelValue","onUpdate:modelValue","identifier"]))),128)}}});function yt(n){const u=n.numberOfChannels,m=n.sampleRate,_=16,w=u*(_/8),h=m*w,k=new ArrayBuffer(44+n.length*w),e=new DataView(k);let l=0;function o(b){for(let V=0;V<b.length;V++)e.setUint8(l++,b.charCodeAt(V))}o("RIFF"),e.setUint32(l,36+n.length*w,!0),l+=4,o("WAVE"),o("fmt "),e.setUint32(l,16,!0),l+=4,e.setUint16(l,1,!0),l+=2,e.setUint16(l,u,!0),l+=2,e.setUint32(l,m,!0),l+=4,e.setUint32(l,h,!0),l+=4,e.setUint16(l,w,!0),l+=2,e.setUint16(l,_,!0),l+=2,o("data"),e.setUint32(l,n.length*w,!0),l+=4;for(let b=0;b<n.length;b++)for(let V=0;V<u;V++){const $=Math.max(-1,Math.min(1,n.getChannelData(V)[b]));e.setInt16(l,$<0?$*32768:$*32767,!0),l+=2}return new Blob([e],{type:"audio/wav"})}async function _t(n){const u=new AudioContext,m=new Map;for(const{voice:l}of n)if(!m.has(l)){const b=await(await fetch(l.file)).arrayBuffer(),V=await u.decodeAudioData(b);m.set(l,V)}let _=0,w=0;for(let l=0;l<n.length;l++){const o=n[l],[b,V]=o.voice.sprite[o.spriteName]||[0,0],$=_+V/1e3;$>w&&(w=$),_+=(V+(o.offset||0))/1e3}const h=new OfflineAudioContext(2,Math.ceil(w*44100),44100);_=0;for(let l=0;l<n.length;l++){const o=n[l],[b,V]=o.voice.sprite[o.spriteName]||[0,0],$=m.get(o.voice);if(!$)return;const C=h.createBufferSource();C.buffer=$;const E=Math.max(0,_);C.start(E,b/1e3,V/1e3),C.connect(h.destination),_+=(V+(o.offset||0))/1e3}const k=await h.startRendering(),e=yt(k);return URL.createObjectURL(e)}const vt={class:"flex",style:{"flex-wrap":"wrap-reverse"}},wt={style:{flex:"50% 1 1"}},Tt={id:"upcoming-announcements"},Vt={class:"room"},ht={class:"title"},bt={class:"time"},Ot={class:"flex chips"},St=["onDblclick"],kt={key:"0"},xt={key:1},$t={style:{position:"relative"}},Nt={key:0},Ut={key:0,class:"dropzone"},Mt=X({__name:"AnnouncerView",setup(n){const u=Me(),m=$e("now"),_=ue("main"),w=ue("audios"),h=z(!1),k=[{id:"plfStart",name:"4DX-inloop",segments:[{spriteName:"chime",offset:-800},{spriteName:"start",offset:0},{spriteName:"auditorium#",offset:0}],enabled:!0,trigger:{property:"scheduledTime",preponeMinutes:15},filter:{plfOnly:!0,lastShowOnly:!1,firstShowOnly:!1,playlistTitleIncludes:"",playlistTitleExcludes:""}},{id:"start",name:"Start",segments:[{spriteName:"chime",offset:-800},{spriteName:"start",offset:0},{spriteName:"auditorium#",offset:0}],enabled:!1,trigger:{property:"scheduledTime",preponeMinutes:0},filter:{plfOnly:!1,lastShowOnly:!1,firstShowOnly:!1,playlistTitleIncludes:"",playlistTitleExcludes:""}},{id:"mainShow",name:"Start hoofdfilm",segments:[{spriteName:"chime",offset:-800},{spriteName:"mainshow",offset:0},{spriteName:"auditorium#",offset:0}],enabled:!1,trigger:{property:"mainShowTime",preponeMinutes:0},filter:{plfOnly:!1,lastShowOnly:!1,firstShowOnly:!1,playlistTitleIncludes:"",playlistTitleExcludes:""}},{id:"intermission",name:"Pauze",segments:[{spriteName:"chime",offset:-800},{spriteName:"intermission",offset:0},{spriteName:"auditorium#",offset:0}],enabled:!0,trigger:{property:"intermissionTime",preponeMinutes:1},filter:{plfOnly:!1,lastShowOnly:!1,firstShowOnly:!1,playlistTitleIncludes:"",playlistTitleExcludes:""}},{id:"credits",name:"Aftiteling",segments:[{spriteName:"chime",offset:-800},{spriteName:"credits",offset:0},{spriteName:"auditorium#",offset:0}],enabled:!0,trigger:{property:"creditsTime",preponeMinutes:1},filter:{plfOnly:!1,lastShowOnly:!1,firstShowOnly:!1,playlistTitleIncludes:"",playlistTitleExcludes:""}},{id:"end",name:"Einde voorstelling",segments:[{spriteName:"chime",offset:-800},{spriteName:"end",offset:0},{spriteName:"auditorium#",offset:0}],enabled:!1,trigger:{property:"endTime",preponeMinutes:0},filter:{plfOnly:!1,lastShowOnly:!1,firstShowOnly:!1,playlistTitleIncludes:"",playlistTitleExcludes:""}},{id:"finalMainShowStart",name:"Start laatste hoofdfilm",segments:[{spriteName:"chime",offset:-800},{spriteName:"finalshow",offset:0}],enabled:!1,trigger:{property:"mainShowTime",preponeMinutes:0},filter:{plfOnly:!1,lastShowOnly:!0,firstShowOnly:!1,playlistTitleIncludes:"",playlistTitleExcludes:""}}],e=Y("default-rules",k,localStorage,{mergeDefaults:!0});for(let r=0;r<k.length;r++){const t=k[r];e.value.findIndex(T=>T.id===t.id)===-1&&e.value.splice(r,0,t)}const l=Y("custom-rules",[],localStorage,{mergeDefaults:!0}),o=Y("preferred-voices",["default"],localStorage,{mergeDefaults:!0}),b=z([{spriteName:"chime",offset:-800}]),V=z([]);u.$subscribe(C,{deep:!0});let $=null;Se(()=>{C(),$=setInterval(E,1e4)}),ke(()=>{$&&clearInterval($)});function C(){w.value.innerHTML="";let r=[];for(const t of[...e.value,...l.value]){if(!t.enabled)continue;let v=[];u.table.forEach((T,U)=>{if(D(T,U,t)){const O={time:new Date(T[t.trigger.property].getTime()-(t.trigger.preponeMinutes||0)*6e4-5e3),show:T,segments:t.segments.map(j=>({...j,spriteName:j.spriteName.replace("#",`${String(T.auditoriumNumber).padStart(2,"0")}`)})),audio:null};O.time.getTime()>Date.now()&&v.push(O)}}),v.sort((T,U)=>T.time.getTime()-U.time.getTime()),t.filter.firstShowOnly&&(v=v.slice(0,1)),t.filter.lastShowOnly&&(v=v.slice(-1)),r.push(...v)}V.value=r.sort((t,v)=>t.time.getTime()-v.time.getTime()),E()}async function E(){for(const r of V.value){const t=r.time.getTime()-Date.now()-1e3;if(t>-1e3&&t<1e4&&!r.audio){const v=M(r.segments,o.value.map(T=>A[T]));r.audio=await f(v),w.value.appendChild(r.audio),setTimeout(()=>{var U;const T=Array.from(w.value.children).find(O=>O!==r.audio&&!O.paused);T?T.addEventListener("ended",()=>{var O;(O=r.audio)==null||O.play()},{once:!0}):(U=r.audio)==null||U.play()},Math.max(0,t))}}}function D(r,t,v){let T=!0;return!r[v.trigger.property]||!r[v.trigger.property].getTime()?!1:(v.filter.plfOnly&&!r.auditorium.includes("4DX")&&(T=!1),v.filter.playlistTitleIncludes&&!r.title.toLowerCase().includes(v.filter.playlistTitleIncludes.toLowerCase())&&(T=!1),v.filter.playlistTitleExcludes&&r.title.toLowerCase().includes(v.filter.playlistTitleExcludes.toLowerCase())&&(T=!1),T)}function i(r){return r<6e4?Math.floor(r/1e3)+" s":r<6e5?Math.floor(r/6e4)+":"+String(Math.floor(r%6e4/1e3)).padStart(2,"0")+" min":r<36e5?Math.floor(r/6e4)+" min":Math.floor(r/36e5)+":"+String(Math.floor(r%36e5/6e4)).padStart(2,"0")+" h"}function M(r,t){const v=t.sort(()=>.5-Math.random()),T=Object.values(A);for(const U of v)if(r.every(O=>O.spriteName==="chime"||U.sprite[O.spriteName]))return r.map(O=>({...O,voice:O.spriteName==="chime"?A.default:U}));return r.map(U=>{const O=[...v,...T].find(j=>j.sprite[U.spriteName]);return{...U,voice:(U.spriteName==="chime"?A.default:O)||A.default}})}function f(r){return new Promise(async t=>{const v=await _t(r),T=new Audio(v);T.addEventListener("ended",()=>{T.remove()}),t(T)})}async function L(r,t=o.value.map(v=>A[v])){const v=M(r,t);(await f(v)).play()}const{isOverDropZone:ge}=De(_,{onDrop:u.filesUploaded,multiple:!1});return(r,t)=>{const v=xe,T=Ce,U=Be,O=le,j=ct,ce=pe,ne=oe,ye=Ae,se=gt,ae=he,_e=Ve,ve=te;return a(),y("main",{ref_key:"main",ref:_},[p(v),p(T),s("section",null,[s("div",vt,[s("div",wt,[t[9]||(t[9]=s("h2",null,"Geplande omroepen",-1)),s("div",Tt,[p(Ne,{name:"list"},{default:d(()=>[(a(!0),y(B,null,R(V.value,c=>me((a(),y("div",{class:J(["film",{announcing:c.audio&&!c.audio.paused}]),key:c.time.getTime()},[s("div",Vt,S(c.show.auditorium==="PULR 8"||c.show.auditorium==="Rooftop"?"RT":c.show.auditorium.replace(/^\w+\s/,"")),1),s("div",ht,S(c.show.title),1),s("div",bt,S(x(K)(c.show.scheduledTime,"HH:mm"))+" – "+S(x(K)(c.show.endTime,"HH:mm:ss")),1),s("div",Ot,[(a(!0),y(B,null,R(c.show.extras,P=>(a(),I(U,{class:J({"translucent-white":P.match(/\(.+\)/)})},{default:d(()=>[g(S(P.replace(/\((.+)\)/,"$1")),1)]),_:2},1032,["class"]))),256))]),s("div",{class:"announcement",onDblclick:P=>L(c.segments),style:{display:"grid","grid-template-columns":"64px 130px 1fr"}},[p(O,null,{default:d(()=>t[8]||(t[8]=[g("schedule")])),_:1,__:[8]}),s("div",null,S(x(K)(c.time,"HH:mm:ss"))+" ("+S(i(c.time.getTime()-x(m).getTime()))+") ",1),s("div",null," '"+S(c.segments.map(P=>x(G)(P.spriteName).name).join(" "))+"' ",1)],40,St)],2)),[[Ue,c.time.getTime()-x(m).getTime()>-5e3||c.audio&&!c.audio.paused]])),128)),V.value.filter(c=>x(m).getTime()-c.time.getTime()<1e4).length<1?(a(),y("p",kt,"Er zijn geen omroepen gepland.")):N("",!0),x(u).table.length<1?(a(),y("p",xt,"Upload eerst een bestand.")):N("",!0)]),_:1})])]),p(ye,{style:{flex:"30% 1 1"}},{default:d(()=>[t[17]||(t[17]=s("h2",null,"Opties",-1)),s("fieldset",null,[t[10]||(t[10]=s("legend",null,"Stemmen",-1)),p(j,{modelValue:x(o),"onUpdate:modelValue":t[0]||(t[0]=c=>Z(o)?o.value=c:null)},null,8,["modelValue"])]),s("fieldset",$t,[t[13]||(t[13]=s("legend",null,"Handmatige omroep",-1)),p(ce,{modelValue:b.value,"onUpdate:modelValue":t[1]||(t[1]=c=>b.value=c),"play-button":"",class:"full",onPlay:t[2]||(t[2]=c=>L(b.value))},{default:d(()=>[p(O,null,{default:d(()=>t[11]||(t[11]=[g("build")])),_:1,__:[11]}),t[12]||(t[12]=s("span",null,"Omroep maken",-1))]),_:1,__:[12]},8,["modelValue"])]),s("fieldset",null,[t[16]||(t[16]=s("legend",null,"Regels",-1)),p(ne,{class:"secondary full",onClick:t[3]||(t[3]=c=>h.value=!0)},{default:d(()=>[p(O,null,{default:d(()=>t[14]||(t[14]=[g("edit")])),_:1,__:[14]}),s("span",null,[t[15]||(t[15]=g("Regels bewerken ")),x(l).filter(c=>c.enabled).length?(a(),y("small",Nt,"(eigen regels: "+S(x(l).filter(c=>c.enabled).length)+" actief)",1)):N("",!0)])]),_:1})])]),_:1,__:[17]})])]),p(ie,null,{default:d(()=>[h.value?(a(),I(ve,{key:0,onDismiss:t[7]||(t[7]=c=>h.value=!1)},{default:d(()=>[p(_e,null,{default:d(()=>[p(ae,{value:"Standaardregels"},{default:d(()=>[p(se,{modelValue:x(e),"onUpdate:modelValue":t[4]||(t[4]=c=>Z(e)?e.value=c:null),toggleOnly:!0},null,8,["modelValue"])]),_:1}),p(ae,{value:"Eigen regels"},{default:d(()=>[p(se,{modelValue:x(l),"onUpdate:modelValue":t[5]||(t[5]=c=>Z(l)?l.value=c:null),toggleOnly:!1},null,8,["modelValue"])]),_:1})]),_:1}),p(ne,{class:"full",onClick:t[6]||(t[6]=c=>{C(),h.value=!1}),style:{"margin-top":"16px"}},{default:d(()=>[p(O,null,{default:d(()=>t[18]||(t[18]=[g("refresh")])),_:1,__:[18]}),t[19]||(t[19]=s("span",null,"Omroepen klaarzetten",-1))]),_:1,__:[19]})]),_:1})):N("",!0)]),_:1}),x(ge)?(a(),y("div",Ut," Laat los om bestand te uploaden ")):N("",!0),s("div",{ref_key:"audios",ref:w,id:"audios"},null,512)],512)}}}),Lt=Q(Mt,[["__scopeId","data-v-0952e7cb"]]);export{Lt as default};
